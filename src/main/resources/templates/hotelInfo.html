<!--
    æ–‡ä»¶åç§°ï¼šhotelInfo.html
    æ–‡ä»¶åŠŸèƒ½ï¼šé…’åº—è¯¦æƒ…é¡µé¢æ¨¡æ¿ï¼ˆå•æˆ¿å‹é…’åº—ï¼‰
    åŠŸèƒ½æ¦‚è¿°ï¼š
        1. æ˜¾ç¤ºé…’åº—è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬é…’åº—å›¾ç‰‡ã€åç§°ã€è¯„åˆ†ã€åœ°å€ã€æè¿°ç­‰
        2. æ˜¾ç¤ºé…’åº—è®¾æ–½ä¿¡æ¯
        3. æ˜¾ç¤ºæˆ¿å‹é€‰æ‹©åˆ—è¡¨ï¼ˆä»åç«¯åŠ¨æ€åŠ è½½ï¼‰
        4. æä¾›é¢„è®¢åŠŸèƒ½ï¼ŒåŒ…æ‹¬é¢„è®¢å¼¹çª—ã€è¡¨å•éªŒè¯ã€è®¢å•æ‘˜è¦è®¡ç®—ç­‰
        5. é›†æˆå®¢æˆ·è¯„ä»·å±•ç¤ºåŠŸèƒ½
        6. å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒPCç«¯å’Œç§»åŠ¨ç«¯è®¿é—®
    æŠ€æœ¯æ ˆï¼šHTML5 + CSS3 + JavaScript + Thymeleafæ¨¡æ¿å¼•æ“
    ä¾èµ–æ–‡ä»¶ï¼š
        - /css/navbar.cssï¼ˆå¯¼èˆªæ æ ·å¼ï¼‰
        - /css/hotelManyInfo.cssï¼ˆé…’åº—è¯¦æƒ…æ ·å¼ï¼‰
        - Font Awesomeå›¾æ ‡åº“ï¼ˆCDNï¼‰
    ä½œè€…ï¼šæ¸¸å¸‚ç”Ÿæ´»å¼€å‘å›¢é˜Ÿ
    åˆ›å»ºæ—¥æœŸï¼š2024å¹´
    æœ€åæ›´æ–°ï¼š2024å¹´
-->
<!DOCTYPE html>
<!-- HTML5æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªHTML5æ–‡æ¡£ -->
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<!-- 
    HTMLæ ¹å…ƒç´ 
    lang="zh-CN"ï¼šè®¾ç½®é¡µé¢è¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡
    xmlns:th="http://www.thymeleaf.org"ï¼šå£°æ˜Thymeleafå‘½åç©ºé—´ï¼Œç”¨äºæ¨¡æ¿å¼•æ“è¯­æ³•
-->
<head>
    <!-- HTMLæ–‡æ¡£å¤´éƒ¨ï¼ŒåŒ…å«å…ƒæ•°æ®å’Œæ ·å¼è¡¨å¼•ç”¨ -->
    <!-- å­—ç¬¦ç¼–ç å£°æ˜ï¼ŒæŒ‡å®šé¡µé¢ä½¿ç”¨UTF-8ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡ç­‰å¤šè¯­è¨€å­—ç¬¦ -->
    <meta charset="UTF-8">
    <!-- è§†å£å…ƒæ•°æ®ï¼Œè®¾ç½®é¡µé¢åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºæ–¹å¼ï¼Œwidth=device-widthè¡¨ç¤ºå®½åº¦è‡ªé€‚åº”è®¾å¤‡å®½åº¦ï¼Œinitial-scale=1.0è¡¨ç¤ºåˆå§‹ç¼©æ”¾æ¯”ä¾‹ä¸º1.0 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- é¡µé¢æ ‡é¢˜ï¼Œä½¿ç”¨ThymeleafåŠ¨æ€æ˜¾ç¤ºé…’åº—åç§° -->
    <title th:text="'æ¸¸å¸‚ç”Ÿæ´» - ' + ${hotel.name}">æ¸¸å¸‚ç”Ÿæ´» - é…’åº—ä¿¡æ¯</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/navbar.css">
    <link rel="stylesheet" href="/css/hotelManyInfo.css">
    <style>
        body {
            background-color: #f9f9f9;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            margin-top: 90px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            padding: 20px;
        }

        /* é…’åº—è‹±é›„åŒºåŸŸ */
        .hotel-hero {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 500px;
        }

        .hotel-gallery {
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .main-image {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 500px;
        }

        .main-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-overlay {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .rating-badge {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 8px 16px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            color: #FF6600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .hotel-details {
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hotel-header {
            margin-bottom: 20px;
        }

        .hotel-name {
            font-size: 2.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .hotel-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stars {
            display: flex;
            gap: 2px;
        }

        .stars i {
            color: #ddd;
            font-size: 16px;
        }

        .stars i.filled {
            color: #FFD700;
        }

        .rating-text {
            font-weight: bold;
            color: #FF6600;
            font-size: 1.1rem;
        }

        .hotel-level {
            background: linear-gradient(45deg, #FF6600, #FF8C00);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .hotel-location {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .hotel-location i {
            color: #FF6600;
        }

        .hotel-contact {
            margin-bottom: 20px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 16px;
        }

        .contact-item i {
            color: #FF6600;
        }

        .hotel-description {
            color: #777;
            line-height: 1.7;
            font-size: 16px;
            margin-bottom: 30px;
            flex: 1;
        }

        .hotel-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .price-section {
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .price-label {
            font-size: 14px;
            color: #999;
        }

        .price-amount {
            font-size: 2rem;
            font-weight: bold;
            color: #FF6600;
        }

        .price-unit {
            font-size: 14px;
            color: #999;
        }

        .book-btn {
            background: linear-gradient(45deg, #FF6600, #FF8C00);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .book-btn:hover {
            background: linear-gradient(45deg, #e55a00, #e67e00);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 102, 0, 0.3);
        }

        /* è®¾æ–½åŒºåŸŸæ ·å¼ */
        .facilities-section, .reviews-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-header h2 {
            font-size: 2rem;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .section-header h2 i {
            color: #FF6600;
        }

        .section-header p {
            color: #666;
            font-size: 16px;
        }

        .facility-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .facility-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }

        .facility-card:hover {
            background: #fff;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-5px);
        }

        .facility-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #FF6600, #FF8C00);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .facility-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .facility-info p {
            font-size: 14px;
            color: #666;
            margin: 0;
        }

        /* è¯„ä»·åŒºåŸŸæ ·å¼ */
        .rating-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }

        .rating-summary-left {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .overall-rating {
            font-size: 48px;
            font-weight: bold;
            line-height: 1;
        }

        .rating-stars-summary {
            display: flex;
            gap: 5px;
            font-size: 20px;
        }

        .rating-stars-summary i {
            color: #FFD700;
        }

        .rating-count {
            font-size: 14px;
            opacity: 0.9;
        }

        .rating-summary-right {
            display: flex;
            align-items: center;
        }

        .add-review-btn {
            background: white;
            color: #667eea;
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .add-review-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .add-review-btn i {
            font-size: 18px;
        }

        /* è¯„ä»·ç­›é€‰åŒºåŸŸ */
        .review-filters {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .filter-label {
            font-weight: 600;
            color: #333;
            margin-right: 5px;
        }

        .filter-btn {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .filter-btn:hover {
            border-color: #FF6600;
            color: #FF6600;
        }

        .filter-btn.active {
            background: #FF6600;
            border-color: #FF6600;
            color: white;
        }

        /* è¯„ä»·åˆ—è¡¨ */
        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .review-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .review-item:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-3px);
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .review-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF6600, #FF8C00);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
            flex-shrink: 0;
        }

        .review-user-info {
            flex: 1;
        }

        .review-username {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .review-rating {
            display: flex;
            gap: 3px;
        }

        .review-rating i {
            color: #FFD700;
            font-size: 14px;
        }

        .review-date {
            color: #999;
            font-size: 14px;
        }

        .review-content {
            color: #666;
            line-height: 1.8;
            font-size: 15px;
            margin-top: 10px;
        }

        .no-reviews {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .no-reviews i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .no-reviews p {
            font-size: 16px;
            margin: 0;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {            
            .main-content {
                padding: 15px;
            }
            
            .hotel-hero {
                grid-template-columns: 1fr;
                min-height: auto;
            }
            
            .hotel-details {
                padding: 30px 20px;
            }
            
            .hotel-name {
                font-size: 1.8rem;
            }
            
            .facility-grid {
                grid-template-columns: 1fr;
            }
            
            .review-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆª - ä¸é¦–é¡µä¸€è‡´ -->
    <header class="header">
        <nav class="nav">
            <a href="/" class="logo">
                <i class="fas fa-city"></i>
                æ¸¸å¸‚ç”Ÿæ´»
            </a>
                    <ul class="nav-links">
                <li><a href="/">é¦–é¡µ</a></li>
                <li><a href="/hc/f2">ä½å®¿æœåŠ¡</a></li>
            <li><a href="/travel">å‡ºè¡ŒæœåŠ¡</a></li>
                <li><a href="/food">ç¾é£ŸæœåŠ¡</a></li>
                <li><a href="/shopping">è´­ç‰©æœåŠ¡</a></li>
                <li><a href="/payment">ç”Ÿæ´»ç¼´è´¹</a></li>
        </ul>
            <div class="user-actions">
                <div th:if="${session.user == null}">
                    <a href="/user/login" class="login-btn">ç™»å½•</a>
                    <a href="/user/register" class="register-btn">æ³¨å†Œ</a>
                </div>
                <div th:if="${session.user != null}">
                    <a href="/unified-new/orders" style="color: #FF6600; text-decoration: none; font-weight: 500; margin-right: 15px;">
                        <i class="fas fa-list-alt"></i>
                        æˆ‘çš„è®¢å•
                    </a>
                    <a href="/user/profile" style="color: #FF6600; text-decoration: none; font-weight: 500;">
                        <i class="fas fa-user-circle"></i>
                        <span th:text="${session.user.nickname ?: session.user.username}">ç”¨æˆ·</span>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container py-4">
        <!-- è¿”å›æŒ‰é’® -->
        <div class="mb-4">
            <a href="javascript:history.back()" class="text-primary">
                <i class="fas fa-arrow-left mr-1"></i> è¿”å›é…’åº—åˆ—è¡¨
            </a>
        </div>

        <!-- é…’åº—åŸºæœ¬ä¿¡æ¯ -->
        <section class="hotel-hero">
            <div class="hotel-gallery">
                <div class="main-image">
                    <img th:src="${hotel.img}" alt="é…’åº—å¤–è§‚" />
                </div>
            </div>
            
            <div class="hotel-details">
                <div class="hotel-header">
                    <h1 class="hotel-name" th:text="${hotel.name}">é…’åº—åç§°</h1>
                    <div class="hotel-meta">
                        <div class="rating-display">
                            <div class="stars" id="ratingStars">
                                <!-- æ˜Ÿçº§å°†é€šè¿‡JavaScriptæ ¹æ®è¯„åˆ†åŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            <span class="rating-text" id="ratingScore" th:text="${hotel.score != null ? (hotel.score + 'åˆ†') : 'æš‚æ— è¯„åˆ†'}">4.5åˆ†</span>
                        </div>
                        <div class="hotel-level" th:text="${hotel.level}">äº”æ˜Ÿçº§</div>
                    </div>
                </div>
                
                <div class="hotel-location">
                    <i class="fas fa-map-marker-alt"></i>
                    <span th:text="${hotel.address}">åœ°å€</span>
                </div>
                
                <div class="hotel-contact">
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span th:text="${hotel.tel}">0411-77771111</span>
                    </div>
                </div>
                
                <div class="hotel-description" th:text="${hotel.content}">
                    è±ªåå•†åŠ¡åº¦å‡ç»¼åˆä½“ï¼Œé…å¤‡ç±³å…¶æ—é¤å…ã€ç©ºä¸­èŠ±å›­åŠ24å°æ—¶ç®¡å®¶æœåŠ¡ã€‚
                </div>
                
                <div class="hotel-actions">
                    <div class="price-section">
                        <div class="price-label">èµ·ä»·</div>
                        <div class="price-amount">Â¥<span id="minPrice" th:text="${hotel.minPrice}">788</span></div>
                        <div class="price-unit">/æ™š</div>
                    </div>
                    <button id="bookNowBtn" class="book-btn">
                        <i class="fas fa-calendar-check"></i>
                        ç«‹å³é¢„è®¢
                    </button>
                </div>
            </div>
        </section>

        <!-- é…’åº—è®¾æ–½ -->
        <section class="facilities-section">
            <div class="section-header">
                <h2><i class="fas fa-cog"></i> é…’åº—è®¾æ–½</h2>
                <p>ä¸ºæ‚¨æä¾›èˆ’é€‚ä¾¿æ·çš„ä½å®¿ä½“éªŒ</p>
            </div>
            <div class="facility-grid">
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-wifi"></i>
                    </div>
                    <div class="facility-info">
                        <h4>å…è´¹WiFi</h4>
                        <p>é«˜é€Ÿæ— çº¿ç½‘ç»œè¦†ç›–</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="facility-info">
                        <h4>é¤å…</h4>
                        <p>ç²¾è‡´ç¾é£Ÿä½“éªŒ</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-volume-mute"></i>
                    </div>
                    <div class="facility-info">
                        <h4>è¶…å¼ºéš”éŸ³</h4>
                        <p>å®‰é™èˆ’é€‚çš„ç¡çœ ç¯å¢ƒ</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="facility-info">
                        <h4>åœè½¦åœº</h4>
                        <p>å…è´¹åœè½¦æœåŠ¡</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="facility-info">
                        <h4>å¥èº«æˆ¿</h4>
                        <p>24å°æ—¶å¥èº«è®¾æ–½</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-bath"></i>
                    </div>
                    <div class="facility-info">
                        <h4>ç‹¬ç«‹å«æµ´</h4>
                        <p>è±ªåå«æµ´è®¾æ–½</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-tv"></i>
                    </div>
                    <div class="facility-info">
                        <h4>æ™ºèƒ½ç”µè§†</h4>
                        <p>é«˜æ¸…å¨±ä¹ä½“éªŒ</p>
                    </div>
                </div>
                <div class="facility-card">
                    <div class="facility-icon">
                        <i class="fas fa-thermometer-half"></i>
                    </div>
                    <div class="facility-info">
                        <h4>ä¸­å¤®ç©ºè°ƒ</h4>
                        <p>æ’æ¸©èˆ’é€‚ç¯å¢ƒ</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- å®¢æˆ·è¯„ä»· -->
        <section class="reviews-section">
            <div class="section-header">
                <h2><i class="fas fa-comment"></i> å®¢æˆ·è¯„ä»·</h2>
                <p>çœŸå®ç”¨æˆ·åé¦ˆï¼Œä¸ºæ‚¨æä¾›å‚è€ƒ</p>
            </div>
            
            <!-- è¯„åˆ†æ‘˜è¦åŒºåŸŸ -->
            <div class="rating-summary">
                <div class="rating-summary-left">
                    <div class="overall-rating" th:text="${ratingStats?.avgRating != null ? #numbers.formatDecimal(ratingStats.avgRating, 1, 1) : (hotel.score != null ? #numbers.formatDecimal(hotel.score, 1, 1) : '0.0')}">4.5</div>
                    <div class="rating-stars-summary" id="ratingStarsSummary">
                        <!-- æ˜Ÿçº§å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="rating-count" th:text="'åŸºäº ' + ${ratingStats?.reviewCount != null ? ratingStats.reviewCount : 0} + ' æ¡è¯„ä»·'">åŸºäº 0 æ¡è¯„ä»·</div>
                </div>
                <div class="rating-summary-right">
                    <button id="addReviewBtn" class="add-review-btn">
                        <i class="fas fa-edit"></i>
                        <span>å†™è¯„ä»·</span>
                    </button>
                </div>
            </div>
            
            <!-- è¯„ä»·ç­›é€‰åŒºåŸŸ -->
            <div class="review-filters">
                <span class="filter-label">ç­›é€‰ï¼š</span>
                <button class="filter-btn active" data-rating="all">å…¨éƒ¨</button>
                <button class="filter-btn" data-rating="5">5æ˜Ÿ</button>
                <button class="filter-btn" data-rating="4">4æ˜Ÿ</button>
                <button class="filter-btn" data-rating="3">3æ˜Ÿ</button>
                <button class="filter-btn" data-rating="2">2æ˜Ÿ</button>
                <button class="filter-btn" data-rating="1">1æ˜Ÿ</button>
            </div>
            
            <!-- è¯„ä»·åˆ—è¡¨ -->
            <div id="reviews" class="reviews-list">
                <!-- è¯„è®ºå°†é€šè¿‡Thymeleafä»åç«¯åŠ è½½ -->
                <div th:each="review : ${reviews}" class="review-item" th:data-rating="${review.rating}">
                    <div class="review-header">
                        <div class="review-avatar" th:text="${review.username != null ? #strings.substring(review.username, 0, 1) : 'U'}">U</div>
                        <div class="review-user-info">
                            <div class="review-username" th:text="${review.username}">ç”¨æˆ·å</div>
                            <div class="review-rating" th:data-rating="${review.rating}">
                                <!-- æ˜Ÿçº§å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                        <div class="review-date" th:text="${review.createTime != null ? #temporals.format(review.createTime, 'yyyy-MM-dd') : ''}">2024-01-01</div>
                    </div>
                    <div class="review-content" th:text="${review.content}">è¯„è®ºå†…å®¹</div>
                </div>
                <!-- å¦‚æœæ²¡æœ‰è¯„è®º -->
                <div th:if="${reviews == null || #lists.isEmpty(reviews)}" class="no-reviews">
                    <i class="fas fa-comment-slash"></i>
                    <p>æš‚æ— è¯„ä»·ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä¸ªè¯„ä»·çš„ç”¨æˆ·å§ï¼</p>
                </div>
            </div>
        </section>
    </main>

    <!-- æ·»åŠ è¯„è®ºå¼¹çª— -->
    <div id="reviewModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ è¯„è®º</h3>
                <span id="closeReviewModal" class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="reviewForm">
                    <input type="hidden" id="reviewHotelId" th:value="${hotel.id}" />
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">è¯„åˆ† <span id="selectedRating" style="color: #FF6600; margin-left: 10px;"></span></label>
                        <div class="star-rating" style="display: flex; gap: 8px; font-size: 32px; margin: 15px 0; align-items: center;">
                            <input type="radio" id="star5" name="rating" value="5" style="display: none;" />
                            <label for="star5" class="star" style="cursor: pointer; color: #ddd; transition: all 0.2s ease; user-select: none;">â˜…</label>
                            <input type="radio" id="star4" name="rating" value="4" style="display: none;" />
                            <label for="star4" class="star" style="cursor: pointer; color: #ddd; transition: all 0.2s ease; user-select: none;">â˜…</label>
                            <input type="radio" id="star3" name="rating" value="3" style="display: none;" />
                            <label for="star3" class="star" style="cursor: pointer; color: #ddd; transition: all 0.2s ease; user-select: none;">â˜…</label>
                            <input type="radio" id="star2" name="rating" value="2" style="display: none;" />
                            <label for="star2" class="star" style="cursor: pointer; color: #ddd; transition: all 0.2s ease; user-select: none;">â˜…</label>
                            <input type="radio" id="star1" name="rating" value="1" style="display: none;" />
                            <label for="star1" class="star" style="cursor: pointer; color: #ddd; transition: all 0.2s ease; user-select: none;">â˜…</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reviewContent">è¯„è®ºå†…å®¹</label>
                        <textarea id="reviewContent" rows="5" required placeholder="è¯·è¾“å…¥æ‚¨çš„è¯„è®º..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="padding: 10px 20px; background: #FF6600; color: white; border: none; border-radius: 5px; cursor: pointer;">æäº¤è¯„è®º</button>
                </form>
            </div>
        </div>
    </div>

    <!-- é¢„è®¢å¼¹çª— -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">å¡«å†™é¢„è®¢ä¿¡æ¯</h3>
                <span id="closeModal" class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="bookingForm">
                    <input type="hidden" id="bookHotelId" value="" />
                    <input type="hidden" id="bookRoomId" value="" />
                    <input type="hidden" id="bookRoomName" value="" />
                    <input type="hidden" id="bookRoomPrice" value="" />
                    <input type="hidden" id="bookTotalPrice" value="0" />

                    <!-- å…¥ä½æ—¥æœŸ -->
                    <div class="form-group">
                        <label for="checkInDate">å…¥ä½æ—¥æœŸ</label>
                        <input type="date" id="checkInDate" required />
                    </div>

                    <!-- ç¦»åº—æ—¥æœŸ -->
                    <div class="form-group">
                        <label for="checkOutDate">ç¦»åº—æ—¥æœŸ</label>
                        <input type="date" id="checkOutDate" required />
                    </div>

                    <!-- æˆ¿å‹é€‰æ‹© -->
                    <div class="form-group">
                        <label for="roomType">é€‰æ‹©æˆ¿å‹</label>
                        <select id="roomType" required>
                            <option value="">è¯·é€‰æ‹©æˆ¿å‹</option>
                            <!-- æˆ¿å‹é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="guests">å…¥ä½äººæ•°</label>
                        <select id="guests" required>
                            <option value="1">1äºº</option>
                            <option value="2" selected>2äºº</option>
                            <option value="3">3äºº</option>
                            <option value="4">4äºº</option>
                            <option value="5">5äºº</option>
                            <option value="6">6äºº</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="contactName">è”ç³»äººå§“å</label>
                        <input type="text" id="contactName" required />
                    </div>

                    <div class="form-group">
                        <label for="contactPhone">è”ç³»ç”µè¯</label>
                        <input type="tel" id="contactPhone" required />
                    </div>

                    <div class="form-group">
                        <label for="notes">ç‰¹æ®Šè¦æ±‚ (é€‰å¡«)</label>
                        <textarea id="notes" rows="3"></textarea>
                    </div>

                    <div class="summary">
                        <h4>è®¢å•æ‘˜è¦</h4>
                        <div class="summary-item">
                            <span>é…’åº—åç§°</span>
                            <span id="summaryHotelName" th:text="${hotel.name}">é…’åº—åç§°</span>
                        </div>
                        <div class="summary-item">
                            <span>æˆ¿å‹</span>
                            <span id="summaryRoomName">è¯·é€‰æ‹©æˆ¿å‹</span>
                        </div>
                        <div class="summary-item">
                            <span>å…¥ä½äººæ•°</span>
                            <span id="summaryGuests">2äºº</span>
                        </div>
                        <div class="summary-item">
                            <span>å•ä»·</span>
                            <span id="summaryPrice">Â¥0/æ™š</span>
                        </div>
                        <div class="summary-item">
                            <span>å…¥ä½å¤©æ•°</span>
                            <span id="summaryDays">0æ™š</span>
                        </div>
                        <div class="summary-item summary-total">
                            <span>æ€»è®¡</span>
                            <span id="summaryTotal">Â¥0</span>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-check mr-1"></i> ç¡®è®¤é¢„è®¢
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- 
        JavaScriptä»£ç å—
        åŠŸèƒ½æ¦‚è¿°ï¼šå®ç°é…’åº—è¯¦æƒ…é¡µé¢çš„äº¤äº’åŠŸèƒ½ï¼ŒåŒ…æ‹¬é¢„è®¢å¼¹çª—æ§åˆ¶ã€æˆ¿å‹æ•°æ®åŠ è½½ã€è¡¨å•éªŒè¯ã€è®¢å•æ‘˜è¦è®¡ç®—ç­‰
    -->
    <script>
        /**
         * æ–‡ä»¶çº§æ³¨é‡Šï¼šé…’åº—è¯¦æƒ…é¡µé¢JavaScriptåŠŸèƒ½æ¨¡å—
         * åŠŸèƒ½æ¦‚è¿°ï¼š
         *   1. é¢„è®¢å¼¹çª—æ§åˆ¶åŠŸèƒ½ï¼ˆæ‰“å¼€ã€å…³é—­ã€å¤–éƒ¨ç‚¹å‡»å…³é—­ï¼‰
         *   2. æˆ¿å‹æ•°æ®åŠ è½½åŠŸèƒ½ï¼ˆä»åç«¯APIè·å–æˆ¿å‹æ•°æ®ï¼‰
         *   3. è®¢å•æ‘˜è¦æ›´æ–°åŠŸèƒ½ï¼ˆæ ¹æ®æ—¥æœŸã€æˆ¿å‹ã€äººæ•°è®¡ç®—æ€»ä»·ï¼‰
         *   4. è¡¨å•éªŒè¯åŠŸèƒ½ï¼ˆå¿…å¡«å­—æ®µã€æ—¥æœŸéªŒè¯ã€æ‰‹æœºå·éªŒè¯ç­‰ï¼‰
         *   5. é¢„è®¢è¡¨å•æäº¤åŠŸèƒ½ï¼ˆå‘é€é¢„è®¢è¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†å“åº”å¹¶è·³è½¬ï¼‰
         *   6. å®¢æˆ·è¯„ä»·ç”ŸæˆåŠŸèƒ½ï¼ˆåŠ¨æ€ç”Ÿæˆè¯„ä»·åˆ—è¡¨ï¼‰
         *   7. å…¥ä½äººæ•°éªŒè¯åŠŸèƒ½ï¼ˆéªŒè¯å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹é™åˆ¶ï¼‰
         */
        
        // ==================== é¢„è®¢å¼¹çª—åŠŸèƒ½æ¨¡å— ====================
        /**
         * é¢„è®¢å¼¹çª—åŠŸèƒ½
         * åŠŸèƒ½æ¦‚è¿°ï¼šç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œåˆå§‹åŒ–é¢„è®¢å¼¹çª—ç›¸å…³çš„æ‰€æœ‰åŠŸèƒ½
         */
        // ç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œå½“DOMåŠ è½½å®Œæˆåè§¦å‘
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–ç«‹å³é¢„è®¢æŒ‰é’®å…ƒç´ 
            const bookBtn = document.getElementById('bookNowBtn');
            // è·å–é¢„è®¢å¼¹çª—æ¨¡æ€æ¡†å…ƒç´ 
            const modal = document.getElementById('bookingModal');
            // è·å–å…³é—­å¼¹çª—æŒ‰é’®å…ƒç´ 
            const closeModal = document.getElementById('closeModal');
            // è·å–é¢„è®¢è¡¨å•å…ƒç´ 
            const bookingForm = document.getElementById('bookingForm');
            // è·å–å…¥ä½æ—¥æœŸè¾“å…¥æ¡†å…ƒç´ 
            const checkInDate = document.getElementById('checkInDate');
            // è·å–ç¦»åº—æ—¥æœŸè¾“å…¥æ¡†å…ƒç´ 
            const checkOutDate = document.getElementById('checkOutDate');

            /**
             * æ‰“å¼€é¢„è®¢å¼¹çª—
             * åŠŸèƒ½æ¦‚è¿°ï¼šå½“ç‚¹å‡»ç«‹å³é¢„è®¢æŒ‰é’®æ—¶ï¼Œæ‰“å¼€é¢„è®¢å¼¹çª—ï¼Œè®¾ç½®é»˜è®¤æ—¥æœŸï¼ŒåŠ è½½æˆ¿å‹æ•°æ®ï¼Œæ›´æ–°è®¢å•æ‘˜è¦
             */
            // ç›‘å¬ç«‹å³é¢„è®¢æŒ‰é’®çš„clickäº‹ä»¶ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶è§¦å‘
            bookBtn.addEventListener('click', function() {
                // æ˜¾ç¤ºé¢„è®¢å¼¹çª—ï¼ˆè®¾ç½®displayä¸ºblockï¼‰
                modal.style.display = 'block';
                
                // è®¾ç½®é…’åº—ID
                // ä»URLè·å–é…’åº—ID
                const hotelId = getHotelIdFromUrl();
                // åˆ¤æ–­é…’åº—IDæ˜¯å¦å­˜åœ¨
                if (hotelId) {
                    // å¦‚æœé…’åº—IDå­˜åœ¨ï¼Œè®¾ç½®éšè—å­—æ®µbookHotelIdçš„å€¼
                    document.getElementById('bookHotelId').value = hotelId;
                }
                
                // è®¾ç½®é»˜è®¤æ—¥æœŸ
                // åˆ›å»ºä»Šå¤©çš„æ—¥æœŸå¯¹è±¡
                const today = new Date();
                // åˆ›å»ºæ˜å¤©çš„æ—¥æœŸå¯¹è±¡ï¼ˆä»Šå¤©åŠ 1å¤©ï¼‰
                const tomorrow = new Date(today);
                // è®¾ç½®æ˜å¤©çš„æ—¥æœŸä¸ºä»Šå¤©åŠ 1å¤©
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                // è®¾ç½®å…¥ä½æ—¥æœŸä¸ºä»Šå¤©ï¼ˆæ ¼å¼åŒ–ä¸ºYYYY-MM-DDï¼‰
                checkInDate.value = today.toISOString().split('T')[0];
                // è®¾ç½®ç¦»åº—æ—¥æœŸä¸ºæ˜å¤©ï¼ˆæ ¼å¼åŒ–ä¸ºYYYY-MM-DDï¼‰
                checkOutDate.value = tomorrow.toISOString().split('T')[0];
                
                // åŠ è½½æˆ¿å‹æ•°æ®
                // è°ƒç”¨loadRoomTypeså‡½æ•°ï¼Œä»åç«¯APIè·å–æˆ¿å‹æ•°æ®
                loadRoomTypes();
                
                // æ›´æ–°è®¢å•æ‘˜è¦
                // è°ƒç”¨updateSummaryå‡½æ•°ï¼Œæ ¹æ®å½“å‰é€‰æ‹©çš„æ—¥æœŸã€æˆ¿å‹ã€äººæ•°æ›´æ–°è®¢å•æ‘˜è¦
                updateSummary();
            });

            /**
             * å…³é—­é¢„è®¢å¼¹çª—
             * åŠŸèƒ½æ¦‚è¿°ï¼šå½“ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶ï¼Œå…³é—­é¢„è®¢å¼¹çª—
             */
            // ç›‘å¬å…³é—­æŒ‰é’®çš„clickäº‹ä»¶ï¼Œå½“ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶è§¦å‘
            closeModal.addEventListener('click', function() {
                // éšè—é¢„è®¢å¼¹çª—ï¼ˆè®¾ç½®displayä¸ºnoneï¼‰
                modal.style.display = 'none';
            });

            /**
             * ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
             * åŠŸèƒ½æ¦‚è¿°ï¼šå½“ç‚¹å‡»å¼¹çª—å¤–éƒ¨åŒºåŸŸï¼ˆé®ç½©å±‚ï¼‰æ—¶ï¼Œè‡ªåŠ¨å…³é—­é¢„è®¢å¼¹çª—
             */
            // ç›‘å¬windowçš„clickäº‹ä»¶ï¼Œå½“ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®æ—¶è§¦å‘
            window.addEventListener('click', function(event) {
                // åˆ¤æ–­ç‚¹å‡»ä½ç½®æ˜¯å¦ä¸ºå¼¹çª—æœ¬èº«ï¼ˆé®ç½©å±‚ï¼‰ï¼Œè€Œä¸æ˜¯å¼¹çª—å†…å®¹åŒºåŸŸ
                if (event.target === modal) {
                    // å¦‚æœç‚¹å‡»ä½ç½®ä¸ºå¼¹çª—æœ¬èº«ï¼ˆé®ç½©å±‚ï¼‰ï¼Œéšè—é¢„è®¢å¼¹çª—
                    modal.style.display = 'none';
                }
            });

            /**
             * æ—¥æœŸå˜åŒ–æ—¶æ›´æ–°æ‘˜è¦
             * åŠŸèƒ½æ¦‚è¿°ï¼šå½“å…¥ä½æ—¥æœŸæˆ–ç¦»åº—æ—¥æœŸå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°è®¢å•æ‘˜è¦
             */
            // ç›‘å¬å…¥ä½æ—¥æœŸè¾“å…¥æ¡†çš„changeäº‹ä»¶ï¼Œå½“æ—¥æœŸæ”¹å˜æ—¶è§¦å‘
            checkInDate.addEventListener('change', updateSummary);
            // ç›‘å¬ç¦»åº—æ—¥æœŸè¾“å…¥æ¡†çš„changeäº‹ä»¶ï¼Œå½“æ—¥æœŸæ”¹å˜æ—¶è§¦å‘
            checkOutDate.addEventListener('change', updateSummary);
            
            /**
             * æˆ¿å‹é€‰æ‹©å˜åŒ–æ—¶æ›´æ–°æ‘˜è¦
             * åŠŸèƒ½æ¦‚è¿°ï¼šå½“æˆ¿å‹é€‰æ‹©æˆ–å…¥ä½äººæ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°è®¢å•æ‘˜è¦å¹¶éªŒè¯å…¥ä½äººæ•°
             */
            // è·å–æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†å…ƒç´ 
            const roomTypeSelect = document.getElementById('roomType');
            // è·å–å…¥ä½äººæ•°é€‰æ‹©ä¸‹æ‹‰æ¡†å…ƒç´ 
            const guestsSelect = document.getElementById('guests');
            // ç›‘å¬æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†çš„changeäº‹ä»¶ï¼Œå½“æˆ¿å‹æ”¹å˜æ—¶è§¦å‘
            roomTypeSelect.addEventListener('change', function() {
                // æ›´æ–°è®¢å•æ‘˜è¦
                updateSummary();
                // éªŒè¯å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹é™åˆ¶
                validateGuestCount();
            });
            // ç›‘å¬å…¥ä½äººæ•°é€‰æ‹©ä¸‹æ‹‰æ¡†çš„changeäº‹ä»¶ï¼Œå½“äººæ•°æ”¹å˜æ—¶è§¦å‘
            guestsSelect.addEventListener('change', function() {
                // æ›´æ–°è®¢å•æ‘˜è¦
                updateSummary();
                // éªŒè¯å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹é™åˆ¶
                validateGuestCount();
            });
            
            // åŠ è½½æˆ¿å‹æ•°æ®
            // é¡µé¢åŠ è½½æ—¶è°ƒç”¨loadRoomTypeså‡½æ•°ï¼Œä»åç«¯APIè·å–æˆ¿å‹æ•°æ®
            loadRoomTypes();

            // ==================== è®¢å•æ‘˜è¦æ›´æ–°åŠŸèƒ½æ¨¡å— ====================
            /**
             * æ›´æ–°è®¢å•æ‘˜è¦
             * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®å½“å‰é€‰æ‹©çš„å…¥ä½æ—¥æœŸã€ç¦»åº—æ—¥æœŸã€æˆ¿å‹ã€å…¥ä½äººæ•°ï¼Œè®¡ç®—å¹¶æ›´æ–°è®¢å•æ‘˜è¦ä¿¡æ¯ï¼ˆå…¥ä½å¤©æ•°ã€æˆ¿å‹åç§°ã€å•ä»·ã€æ€»ä»·ç­‰ï¼‰
             */
            function updateSummary() {
                // è·å–å…¥ä½æ—¥æœŸå¯¹è±¡
                const checkIn = new Date(checkInDate.value);
                // è·å–ç¦»åº—æ—¥æœŸå¯¹è±¡
                const checkOut = new Date(checkOutDate.value);
                // è·å–é€‰ä¸­çš„æˆ¿å‹ID
                const selectedRoom = document.getElementById('roomType').value;
                // è·å–é€‰ä¸­çš„å…¥ä½äººæ•°
                const selectedGuests = document.getElementById('guests').value;
                
                // æ›´æ–°å…¥ä½äººæ•°æ˜¾ç¤º
                // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å…¥ä½äººæ•°æ˜¾ç¤ºæ–‡æœ¬
                document.getElementById('summaryGuests').textContent = selectedGuests + 'äºº';
                
                // åˆ¤æ–­å…¥ä½æ—¥æœŸå’Œç¦»åº—æ—¥æœŸæ˜¯å¦æœ‰æ•ˆï¼Œä¸”ç¦»åº—æ—¥æœŸæ™šäºå…¥ä½æ—¥æœŸ
                if (checkIn && checkOut && checkOut > checkIn) {
                    // è®¡ç®—å…¥ä½å¤©æ•°ï¼ˆä½¿ç”¨Math.ceilå‘ä¸Šå–æ•´ï¼Œç¡®ä¿å³ä½¿ä¸è¶³ä¸€å¤©ä¹Ÿç®—ä¸€å¤©ï¼‰
                    const days = Math.ceil((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                    // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å…¥ä½å¤©æ•°æ˜¾ç¤ºæ–‡æœ¬
                    document.getElementById('summaryDays').textContent = days + 'æ™š';
                    
                    // åˆ¤æ–­æ˜¯å¦é€‰æ‹©äº†æˆ¿å‹
                    if (selectedRoom) {
                        // å¦‚æœé€‰æ‹©äº†æˆ¿å‹ï¼Œè·å–æˆ¿å‹æ•°æ®
                        const roomData = getRoomData(selectedRoom);
                        // åˆ¤æ–­æˆ¿å‹æ•°æ®æ˜¯å¦å­˜åœ¨
                        if (roomData) {
                            // å¦‚æœæˆ¿å‹æ•°æ®å­˜åœ¨ï¼Œæ›´æ–°è®¢å•æ‘˜è¦ä¸­çš„æˆ¿å‹åç§°
                            document.getElementById('summaryRoomName').textContent = roomData.name;
                            // æ›´æ–°è®¢å•æ‘˜è¦ä¸­çš„å•ä»·æ˜¾ç¤ºæ–‡æœ¬
                            document.getElementById('summaryPrice').textContent = 'Â¥' + roomData.price + '/æ™š';
                            
                            // è®¡ç®—æ€»ä»·ï¼ˆå…¥ä½å¤©æ•°ä¹˜ä»¥æˆ¿å‹å•ä»·ï¼‰
                            const total = days * roomData.price;
                            // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æ€»ä»·æ˜¾ç¤ºæ–‡æœ¬
                            document.getElementById('summaryTotal').textContent = 'Â¥' + total;
                            // è®¾ç½®éšè—å­—æ®µbookTotalPriceçš„å€¼ï¼ˆç”¨äºè¡¨å•æäº¤ï¼‰
                            document.getElementById('bookTotalPrice').value = total;
                            // è®¾ç½®éšè—å­—æ®µbookRoomIdçš„å€¼ï¼ˆç”¨äºè¡¨å•æäº¤ï¼‰
                            document.getElementById('bookRoomId').value = roomData.id;
                            // è®¾ç½®éšè—å­—æ®µbookRoomNameçš„å€¼ï¼ˆç”¨äºè¡¨å•æäº¤ï¼‰
                            document.getElementById('bookRoomName').value = roomData.name;
                            // è®¾ç½®éšè—å­—æ®µbookRoomPriceçš„å€¼ï¼ˆç”¨äºè¡¨å•æäº¤ï¼‰
                            document.getElementById('bookRoomPrice').value = roomData.price;
                        }
                    // å¦‚æœæœªé€‰æ‹©æˆ¿å‹
                    } else {
                        // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æˆ¿å‹åç§°ä¸º"è¯·é€‰æ‹©æˆ¿å‹"
                        document.getElementById('summaryRoomName').textContent = 'è¯·é€‰æ‹©æˆ¿å‹';
                        // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å•ä»·æ˜¾ç¤ºä¸º"Â¥0/æ™š"
                        document.getElementById('summaryPrice').textContent = 'Â¥0/æ™š';
                        // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æ€»ä»·æ˜¾ç¤ºä¸º"Â¥0"
                        document.getElementById('summaryTotal').textContent = 'Â¥0';
                        // è®¾ç½®éšè—å­—æ®µbookTotalPriceçš„å€¼ä¸º0
                        document.getElementById('bookTotalPrice').value = 0;
                    }
                }
            }

            // ==================== é¢„è®¢è¡¨å•æäº¤æ¨¡å— ====================
            /**
             * é¢„è®¢è¡¨å•æäº¤
             * åŠŸèƒ½æ¦‚è¿°ï¼šç›‘å¬é¢„è®¢è¡¨å•çš„æäº¤äº‹ä»¶ï¼ŒéªŒè¯è¡¨å•æ•°æ®ï¼Œæ ¼å¼åŒ–æ—¶é—´ï¼Œå‘é€é¢„è®¢è¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†å“åº”å¹¶è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
             */
            // ç›‘å¬é¢„è®¢è¡¨å•çš„submitäº‹ä»¶ï¼Œå½“è¡¨å•æäº¤æ—¶è§¦å‘
            bookingForm.addEventListener('submit', function(e) {
                // é˜»æ­¢è¡¨å•çš„é»˜è®¤æäº¤è¡Œä¸ºï¼ˆé¡µé¢è·³è½¬ï¼‰
                e.preventDefault();
                
                // è¡¨å•éªŒè¯
                // è°ƒç”¨validateBookingFormå‡½æ•°éªŒè¯è¡¨å•æ•°æ®
                if (!validateBookingForm()) {
                    // å¦‚æœè¡¨å•éªŒè¯å¤±è´¥ï¼Œç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­æ“ä½œ
                    return;
                }
                
                // æ ¼å¼åŒ–å½“å‰æ—¶é—´ä¸ºåç«¯æœŸæœ›çš„æ ¼å¼
                // åˆ›å»ºå½“å‰æ—¶é—´çš„Dateå¯¹è±¡
                const now = new Date();
                // æ ¼å¼åŒ–æ—¶é—´ä¸º"YYYY-MM-DD HH:mm:ss"æ ¼å¼
                const formattedTime = now.getFullYear() + '-' + 
                    String(now.getMonth() + 1).padStart(2, '0') + '-' +  // æœˆä»½ï¼ˆè¡¥é›¶åˆ°2ä½ï¼‰
                    String(now.getDate()).padStart(2, '0') + ' ' +  // æ—¥æœŸï¼ˆè¡¥é›¶åˆ°2ä½ï¼‰
                    String(now.getHours()).padStart(2, '0') + ':' +  // å°æ—¶ï¼ˆè¡¥é›¶åˆ°2ä½ï¼‰
                    String(now.getMinutes()).padStart(2, '0') + ':' +  // åˆ†é’Ÿï¼ˆè¡¥é›¶åˆ°2ä½ï¼‰
                    String(now.getSeconds()).padStart(2, '0');  // ç§’ï¼ˆè¡¥é›¶åˆ°2ä½ï¼‰
                
                // æ„å»ºè¡¨å•æ•°æ®å¯¹è±¡
                const formData = {
                    hid: parseInt(document.getElementById('bookHotelId').value),  // é…’åº—IDï¼ˆè½¬æ¢ä¸ºæ•´æ•°ï¼‰
                    rid: parseInt(document.getElementById('bookRoomId').value),  // æˆ¿å‹IDï¼ˆè½¬æ¢ä¸ºæ•´æ•°ï¼‰
                    uid: 1,  // ä¸´æ—¶ç”¨æˆ·IDï¼Œå®é™…åº”è¯¥ä»ç™»å½•çŠ¶æ€è·å–
                    rname: document.getElementById('bookRoomName').value,  // æˆ¿å‹åç§°
                    indate: checkInDate.value,  // å…¥ä½æ—¥æœŸ
                    outdate: checkOutDate.value,  // ç¦»åº—æ—¥æœŸ
                    guests: parseInt(document.getElementById('guests').value),  // å…¥ä½äººæ•°ï¼ˆè½¬æ¢ä¸ºæ•´æ•°ï¼‰
                    name: document.getElementById('contactName').value,  // è”ç³»äººå§“å
                    tel: document.getElementById('contactPhone').value,  // è”ç³»ç”µè¯
                    notes: document.getElementById('notes').value || '',  // ç‰¹æ®Šè¦æ±‚ï¼ˆå¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨ç©ºå­—ç¬¦ä¸²ï¼‰
                    status: 0,  // å¾…ç¡®è®¤çŠ¶æ€ï¼ˆ0è¡¨ç¤ºå¾…ç¡®è®¤ï¼‰
                    creatTime: formattedTime,  // åˆ›å»ºæ—¶é—´ï¼ˆæ ¼å¼åŒ–åçš„æ—¶é—´å­—ç¬¦ä¸²ï¼‰
                    price: parseFloat(document.getElementById('bookTotalPrice').value)  // è®¢å•æ€»ä»·ï¼ˆè½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼‰
                };
                
                // æ‰“å°é¢„è®¢ä¿¡æ¯åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                console.log('é¢„è®¢ä¿¡æ¯:', formData);
                
                // ä½¿ç”¨AJAXå‘åç«¯æäº¤æ•°æ®
                // ä½¿ç”¨fetch APIå‘é€POSTè¯·æ±‚åˆ°åç«¯é¢„è®¢æ¥å£
                fetch('/hc/bookings', {
                    method: 'POST',  // è¯·æ±‚æ–¹æ³•ä¸ºPOST
                    headers: {
                        'Content-Type': 'application/json',  // è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šå†…å®¹ç±»å‹ä¸ºJSON
                    },
                    body: JSON.stringify(formData)  // å°†è¡¨å•æ•°æ®å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä½œä¸ºè¯·æ±‚ä½“
                })
                .then(response => {
                    // æ‰“å°HTTPçŠ¶æ€ç åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ğŸ“¨ HTTPçŠ¶æ€ç :', response.status);
                    // æ‰“å°å“åº”çŠ¶æ€æ–‡æœ¬åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ğŸ“¨ å“åº”çŠ¶æ€:', response.statusText);
                    
                    // æ£€æŸ¥å“åº”æ˜¯å¦ä¸ºJSON
                    // è·å–å“åº”å¤´ä¸­çš„content-type
                    const contentType = response.headers.get('content-type');
                    // åˆ¤æ–­content-typeæ˜¯å¦åŒ…å«application/json
                    if (!contentType || !contentType.includes('application/json')) {
                        // å¦‚æœå“åº”ä¸æ˜¯JSONæ ¼å¼ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.error('âŒ å“åº”ä¸æ˜¯JSONæ ¼å¼:', contentType);
                        // å°†å“åº”è½¬æ¢ä¸ºæ–‡æœ¬å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯
                        return response.text().then(text => {
                            console.error('âŒ å“åº”å†…å®¹:', text);
                            // æŠ›å‡ºé”™è¯¯ï¼Œæç¤ºæœåŠ¡å™¨è¿”å›äº†éJSONæ ¼å¼çš„å“åº”
                            throw new Error('æœåŠ¡å™¨è¿”å›äº†éJSONæ ¼å¼çš„å“åº”');
                        });
                    }
                    
                    // å°†å“åº”è½¬æ¢ä¸ºJSONå¯¹è±¡
                    return response.json();
                })
                .then(data => {
                    // æ‰“å°é¢„è®¢æäº¤å“åº”åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ğŸ“¨ é¢„è®¢æäº¤å“åº”:', data);
                    // æ‰“å°å“åº”ç±»å‹åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ğŸ“¨ å“åº”ç±»å‹:', typeof data);
                    // æ‰“å°å“åº”å†…å®¹ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ğŸ“¨ å“åº”å†…å®¹:', JSON.stringify(data));
                    
                    // åˆ¤æ–­åç«¯æ˜¯å¦è¿”å›æˆåŠŸï¼ˆå“åº”ç ä¸º200ï¼‰
                    if (data.code === 200) {
                        // å¦‚æœé¢„è®¢æˆåŠŸï¼Œæ‰“å°æˆåŠŸä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.log('âœ… é¢„è®¢æäº¤æˆåŠŸ!');
                        // æ‰“å°è®¢å•å·åˆ°æ§åˆ¶å°ï¼ˆä¼˜å…ˆä½¿ç”¨orderNoï¼Œå¦åˆ™ä½¿ç”¨dataï¼‰
                        console.log('ğŸ“‹ è®¢å•å· (order_no):', data.orderNo || data.data);
                        // æ‰“å°ç»Ÿä¸€è®¢å•å·åˆ°æ§åˆ¶å°
                        console.log('ğŸ”— ç»Ÿä¸€è®¢å•å·:', data.unifiedOrderNo);
                        // æ‰“å°è·³è½¬é“¾æ¥åˆ°æ§åˆ¶å°
                        console.log('ğŸŒ è·³è½¬é“¾æ¥:', data.redirectUrl);
                        
                        // è·å–è®¢å•å·ï¼ˆä¼˜å…ˆä½¿ç”¨ orderNoï¼Œå¦åˆ™ä½¿ç”¨ dataï¼‰
                        const orderNo = data.orderNo || data.data;
                        
                        // æ˜¾ç¤ºè®¢å•å·æç¤º
                        // ä½¿ç”¨alertæ˜¾ç¤ºé¢„è®¢æˆåŠŸæ¶ˆæ¯å’Œè®¢å•å·
                        alert('é¢„è®¢æˆåŠŸï¼è®¢å•å·ï¼š' + orderNo);
                        
                        // å…³é—­é¢„è®¢å¼¹çª—
                        // éšè—é¢„è®¢å¼¹çª—æ¨¡æ€æ¡†
                        modal.style.display = 'none';
                        
                        // ä¼˜å…ˆä½¿ç”¨ redirectUrl è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
                        // åˆ¤æ–­åç«¯æ˜¯å¦è¿”å›redirectUrl
                        if (data.redirectUrl) {
                            // å¦‚æœè¿”å›redirectUrlï¼Œæ‰“å°è·³è½¬ä¿¡æ¯åˆ°æ§åˆ¶å°
                            console.log('ğŸš€ æ­£åœ¨è·³è½¬åˆ°æ”¯ä»˜é¡µé¢:', data.redirectUrl);
                            // è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
                            window.location.href = data.redirectUrl;
                        // åˆ¤æ–­åç«¯æ˜¯å¦è¿”å›unifiedOrderNo
                        } else if (data.unifiedOrderNo) {
                            // å¦‚æœæ²¡æœ‰ redirectUrl ä½†æœ‰ unifiedOrderNoï¼Œæ‰‹åŠ¨æ„å»ºè·³è½¬é“¾æ¥
                            // æ„å»ºæ”¯ä»˜é¡µé¢è·³è½¬é“¾æ¥ï¼ŒåŒ…å«ç»Ÿä¸€è®¢å•å·å‚æ•°
                            const redirectUrl = '/unified-new/payment/checkout?orderNo=' + encodeURIComponent(data.unifiedOrderNo);
                            // æ‰“å°æ‰‹åŠ¨æ„å»ºçš„è·³è½¬é“¾æ¥åˆ°æ§åˆ¶å°
                            console.log('ğŸ”§ æ‰‹åŠ¨æ„å»ºè·³è½¬é“¾æ¥:', redirectUrl);
                            // è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
                            window.location.href = redirectUrl;
                        // å¦‚æœæ—¢æ²¡æœ‰redirectUrlä¹Ÿæ²¡æœ‰unifiedOrderNo
                        } else {
                            // å¦åˆ™æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯å¹¶è¯¢é—®æ˜¯å¦æŸ¥çœ‹è®¢å•ç®¡ç†
                            // æ‰“å°è­¦å‘Šä¿¡æ¯åˆ°æ§åˆ¶å°
                            console.warn('âš ï¸ æ²¡æœ‰è·³è½¬é“¾æ¥ï¼Œæ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†');
                            // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦æŸ¥çœ‹è®¢å•ç®¡ç†é¡µé¢
                            if (confirm('æ˜¯å¦ç«‹å³æŸ¥çœ‹è®¢å•ç®¡ç†é¡µé¢ï¼Ÿ')) {
                                // å¦‚æœç”¨æˆ·ç¡®è®¤ï¼Œè·³è½¬åˆ°è®¢å•ç®¡ç†é¡µé¢
                                window.location.href = '/unified-new/orders';
                            } else {
                                // å¦‚æœç”¨æˆ·å–æ¶ˆï¼Œæ˜¾ç¤ºæç¤ºæ¶ˆæ¯
                                alert('æ‚¨å¯ä»¥éšæ—¶åœ¨é¡¶éƒ¨å¯¼èˆªæ ä¸­æŸ¥çœ‹è®¢å•ç®¡ç†ï¼');
                            }
                        }
                        
                        // æ¸…ç©ºè¡¨å•
                        // é‡ç½®é¢„è®¢è¡¨å•ï¼Œæ¸…ç©ºæ‰€æœ‰è¾“å…¥å­—æ®µ
                        bookingForm.reset();
                    // å¦‚æœåç«¯è¿”å›å¤±è´¥
                    } else {
                        // æ‰“å°é¢„è®¢å¤±è´¥ä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.error('âŒ é¢„è®¢å¤±è´¥ï¼Œå“åº”ç :', data.code);
                        // æ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.error('âŒ é”™è¯¯ä¿¡æ¯:', data.message);
                        // ä½¿ç”¨alertæ˜¾ç¤ºé¢„è®¢å¤±è´¥æ¶ˆæ¯
                        alert('é¢„è®¢å¤±è´¥ï¼š' + (data.message || 'æœªçŸ¥é”™è¯¯'));
                    }
                })
                .catch(error => {
                    // å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸ï¼Œæ‰“å°è¯¦ç»†é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                    console.error('âŒ é¢„è®¢æäº¤å¤±è´¥!');
                    // æ‰“å°é”™è¯¯ç±»å‹åˆ°æ§åˆ¶å°
                    console.error('âŒ é”™è¯¯ç±»å‹:', error.name);
                    // æ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                    console.error('âŒ é”™è¯¯ä¿¡æ¯:', error.message);
                    // æ‰“å°é”™è¯¯å †æ ˆåˆ°æ§åˆ¶å°
                    console.error('âŒ é”™è¯¯å †æ ˆ:', error.stack);
                    // ä½¿ç”¨alertæ˜¾ç¤ºé¢„è®¢æäº¤å¤±è´¥æ¶ˆæ¯
                    alert('é¢„è®¢æäº¤å¤±è´¥ï¼š' + error.message);
                });
            });
            
            // ==================== è¡¨å•éªŒè¯åŠŸèƒ½æ¨¡å— ====================
            /**
             * è¡¨å•éªŒè¯å‡½æ•°
             * åŠŸèƒ½æ¦‚è¿°ï¼šéªŒè¯é¢„è®¢è¡¨å•çš„æ‰€æœ‰å¿…å¡«å­—æ®µã€æˆ¿å‹é€‰æ‹©ã€æ—¥æœŸæœ‰æ•ˆæ€§ã€æ‰‹æœºå·æ ¼å¼ç­‰
             * @return {Boolean} å¦‚æœè¡¨å•éªŒè¯é€šè¿‡è¿”å›trueï¼Œå¦åˆ™è¿”å›false
             */
            function validateBookingForm() {
                // æ£€æŸ¥å¿…å¡«å­—æ®µ
                // å®šä¹‰å¿…å¡«å­—æ®µIDæ•°ç»„
                const requiredFields = ['contactName', 'contactPhone', 'checkInDate', 'checkOutDate', 'guests'];
                // éå†å¿…å¡«å­—æ®µæ•°ç»„ï¼Œæ£€æŸ¥æ¯ä¸ªå­—æ®µæ˜¯å¦å·²å¡«å†™
                for (let fieldId of requiredFields) {
                    // è·å–å­—æ®µå…ƒç´ 
                    const field = document.getElementById(fieldId);
                    // åˆ¤æ–­å­—æ®µå…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œä¸”å­—æ®µå€¼å»é™¤é¦–å°¾ç©ºæ ¼åä¸ä¸ºç©º
                    if (!field || !field.value.trim()) {
                        // å¦‚æœæœ‰å¿…å¡«å­—æ®µä¸ºç©ºï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                        alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
                        // èšç„¦åˆ°è¯¥å­—æ®µï¼Œæ–¹ä¾¿ç”¨æˆ·è¾“å…¥
                        field.focus();
                        // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                        return false;
                    }
                }
                
                // æ£€æŸ¥æˆ¿å‹é€‰æ‹©
                // è·å–æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†å…ƒç´ 
                const roomType = document.getElementById('roomType');
                // åˆ¤æ–­æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†æ˜¯å¦å­˜åœ¨ï¼Œä¸”æ˜¯å¦å·²é€‰æ‹©æˆ¿å‹
                if (!roomType || !roomType.value) {
                    // å¦‚æœæœªé€‰æ‹©æˆ¿å‹ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert('è¯·é€‰æ‹©æˆ¿å‹');
                    // èšç„¦åˆ°æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†
                    roomType.focus();
                    // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                    return false;
                }
                
                // æ£€æŸ¥éšè—å­—æ®µ
                // è·å–é…’åº—IDéšè—å­—æ®µå…ƒç´ 
                const bookHotelId = document.getElementById('bookHotelId');
                // è·å–æˆ¿å‹IDéšè—å­—æ®µå…ƒç´ 
                const bookRoomId = document.getElementById('bookRoomId');
                // åˆ¤æ–­é…’åº—IDå’Œæˆ¿å‹IDæ˜¯å¦éƒ½å­˜åœ¨
                if (!bookHotelId.value || !bookRoomId.value) {
                    // å¦‚æœé…’åº—IDæˆ–æˆ¿å‹IDä¸ºç©ºï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert('æˆ¿å‹ä¿¡æ¯ä¸å®Œæ•´ï¼Œè¯·é‡æ–°é€‰æ‹©æˆ¿å‹');
                    // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                    return false;
                }
                
                // éªŒè¯æ—¥æœŸ
                // è·å–å…¥ä½æ—¥æœŸå¯¹è±¡
                const checkIn = new Date(checkInDate.value);
                // è·å–ç¦»åº—æ—¥æœŸå¯¹è±¡
                const checkOut = new Date(checkOutDate.value);
                // åˆ›å»ºä»Šå¤©çš„æ—¥æœŸå¯¹è±¡
                const today = new Date();
                // å°†ä»Šå¤©çš„æ—¥æœŸæ—¶é—´è®¾ç½®ä¸º00:00:00ï¼Œç”¨äºæ—¥æœŸæ¯”è¾ƒ
                today.setHours(0, 0, 0, 0);
                
                // åˆ¤æ–­å…¥ä½æ—¥æœŸæ˜¯å¦æ—©äºä»Šå¤©
                if (checkIn < today) {
                    // å¦‚æœå…¥ä½æ—¥æœŸæ—©äºä»Šå¤©ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert('å…¥ä½æ—¥æœŸä¸èƒ½æ—©äºä»Šå¤©');
                    // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                    return false;
                }
                
                // åˆ¤æ–­ç¦»åº—æ—¥æœŸæ˜¯å¦æ™šäºæˆ–ç­‰äºå…¥ä½æ—¥æœŸ
                if (checkOut <= checkIn) {
                    // å¦‚æœç¦»åº—æ—¥æœŸä¸æ™šäºå…¥ä½æ—¥æœŸï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert('é€€æˆ¿æ—¥æœŸå¿…é¡»æ™šäºå…¥ä½æ—¥æœŸ');
                    // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                    return false;
                }
                
                // éªŒè¯æ‰‹æœºå· - åªæ£€æŸ¥æ˜¯å¦ä¸º11ä½æ•°å­—
                // è·å–è”ç³»ç”µè¯è¾“å…¥æ¡†çš„å€¼
                const phoneValue = document.getElementById('contactPhone').value;
                // åˆ¤æ–­æ‰‹æœºå·æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆ11ä½æ•°å­—ï¼‰
                if (!/^\d{11}$/.test(phoneValue)) {
                    // å¦‚æœæ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert('è¯·è¾“å…¥11ä½æ•°å­—çš„æ‰‹æœºå·ç ');
                    // è¿”å›falseï¼Œè¡¨ç¤ºè¡¨å•éªŒè¯å¤±è´¥
                    return false;
                }
                
                // å¦‚æœæ‰€æœ‰éªŒè¯éƒ½é€šè¿‡ï¼Œè¿”å›true
                return true;
            }

            // ç”Ÿæˆéšæœºè¯„ä»·
            generateReviews();
        });
        
        // ==================== æˆ¿å‹æ•°æ®ç®¡ç†æ¨¡å— ====================
        /**
         * æˆ¿å‹æ•°æ®å­˜å‚¨
         * åŠŸèƒ½æ¦‚è¿°ï¼šå­˜å‚¨ä»åç«¯APIè·å–çš„æˆ¿å‹æ•°æ®åˆ—è¡¨
         */
        // æˆ¿å‹æ•°æ®æ•°ç»„ï¼Œåˆå§‹å€¼ä¸ºç©ºæ•°ç»„
        let roomTypes = [];
        
        /**
         * åŠ è½½æˆ¿å‹æ•°æ®
         * åŠŸèƒ½æ¦‚è¿°ï¼šä»URLè·å–é…’åº—IDï¼Œè°ƒç”¨åç«¯APIè·å–æˆ¿å‹æ•°æ®ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºæ— æˆ¿å‹æç¤º
         */
        function loadRoomTypes() {
            // ä»åç«¯APIè·å–çœŸå®çš„æˆ¿å‹æ•°æ®
            // ä»URLè·å–é…’åº—ID
            const hotelId = getHotelIdFromUrl();
            // åˆ¤æ–­é…’åº—IDæ˜¯å¦å­˜åœ¨
            if (!hotelId) {
                // å¦‚æœé…’åº—IDä¸å­˜åœ¨ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                console.error('æ— æ³•è·å–é…’åº—ID');
                // ç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­æ“ä½œ
                return;
            }
            
            // ä½¿ç”¨ç°æœ‰çš„findByManyæ¥å£è·å–æ•°æ®
            // ä½¿ç”¨fetch APIå‘é€GETè¯·æ±‚åˆ°åç«¯findByManyæ¥å£
            fetch(`/hc/findByMany?id=${hotelId}`)
                .then(response => {
                    // åˆ¤æ–­å“åº”æ˜¯å¦æˆåŠŸï¼ˆçŠ¶æ€ç 200-299ï¼‰
                    if (response.ok) {
                        // å¦‚æœå“åº”æˆåŠŸï¼Œè¿”å›HTMLé¡µé¢å†…å®¹ï¼ˆfindByManyè¿”å›çš„æ˜¯HTMLé¡µé¢ï¼‰
                        return response.text();
                    // å¦‚æœå“åº”å¤±è´¥
                    } else {
                        // æ‰“å°è­¦å‘Šä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.warn('APIè¯·æ±‚å¤±è´¥');
                        // æ˜¾ç¤ºæ— æˆ¿å‹æ•°æ®æç¤º
                        showNoRoomMessage();
                        // è¿”å›null
                        return null;
                    }
                })
                .then(htmlContent => {
                    // åˆ¤æ–­æ˜¯å¦è·å–åˆ°HTMLå†…å®¹
                    if (htmlContent) {
                        // å¦‚æœè·å–åˆ°HTMLå†…å®¹ï¼Œæ‰“å°å†…å®¹é•¿åº¦åˆ°æ§åˆ¶å°
                        console.log('è·å–åˆ°HTMLå†…å®¹ï¼Œé•¿åº¦:', htmlContent.length);
                        
                        // ç”±äºfindByManyè¿”å›çš„æ˜¯HTMLé¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒçš„æ–¹æ³•
                        // æš‚æ—¶ä½¿ç”¨é»˜è®¤æ•°æ®ï¼Œä½†åº”è¯¥ä»æ•°æ®åº“è·å–
                        // è°ƒç”¨loadRoomTypesFromDatabaseå‡½æ•°ï¼Œä»æ•°æ®åº“APIè·å–æˆ¿å‹æ•°æ®
                        loadRoomTypesFromDatabase(hotelId);
                    }
                })
                .catch(error => {
                    // å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                    console.error('è·å–æˆ¿å‹æ•°æ®å¤±è´¥:', error);
                    // æ˜¾ç¤ºæ— æˆ¿å‹æ•°æ®æç¤º
                    showNoRoomMessage();
                });
        }
        
        /**
         * è·å–é…’åº—ID
         * åŠŸèƒ½æ¦‚è¿°ï¼šä»URLæŸ¥è¯¢å‚æ•°ä¸­è·å–é…’åº—ID
         * @return {String|null} é…’åº—IDï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›null
         */
        function getHotelIdFromUrl() {
            // åˆ›å»ºURLSearchParamså¯¹è±¡ï¼Œè§£æURLæŸ¥è¯¢å‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            // è·å–idå‚æ•°çš„å€¼
            return urlParams.get('id');
        }
        
        /**
         * å¡«å……æˆ¿å‹é€‰æ‹©æ¡†
         * åŠŸèƒ½æ¦‚è¿°ï¼šå°†æˆ¿å‹æ•°æ®å¡«å……åˆ°æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ä¸­ï¼Œå¹¶ä¸ºæ¯ä¸ªé€‰é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
         */
        function populateRoomSelect() {
            // è·å–æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†å…ƒç´ 
            const roomTypeSelect = document.getElementById('roomType');
            // æ¸…ç©ºæˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ï¼Œå¹¶æ·»åŠ é»˜è®¤é€‰é¡¹
            roomTypeSelect.innerHTML = '<option value="">è¯·é€‰æ‹©æˆ¿å‹</option>';
            
            // éå†æˆ¿å‹æ•°æ®æ•°ç»„ï¼Œä¸ºæ¯ä¸ªæˆ¿å‹åˆ›å»ºé€‰é¡¹
            roomTypes.forEach(room => {
                // æ£€æŸ¥æˆ¿å‹æ˜¯å¦æ»¡äººï¼ˆfull=1è¡¨ç¤ºæ»¡äººï¼‰
                const isFull = room.full === 1 || room.full === '1' || room.full === true;
                
                // å¦‚æœæˆ¿å‹æ»¡äººï¼Œä¸æ˜¾ç¤ºè¯¥é€‰é¡¹ï¼ˆæˆ–è€…æ˜¾ç¤ºä½†æ ‡è®°ä¸ºç¦ç”¨ï¼‰
                // æ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼Œè¿™é‡Œé€‰æ‹©ä¸æ˜¾ç¤ºæ»¡äººæˆ¿å‹
                if (isFull) {
                    return; // è·³è¿‡æ»¡äººæˆ¿å‹ï¼Œä¸æ·»åŠ åˆ°ä¸‹æ‹‰æ¡†
                }
                
                // åˆ›å»ºoptionå…ƒç´ 
                const option = document.createElement('option');
                // è®¾ç½®optionçš„valueä¸ºæˆ¿å‹ID
                option.value = room.id;
                // è®¾ç½®optionçš„æ–‡æœ¬å†…å®¹ä¸º"æˆ¿å‹åç§° - ä»·æ ¼/æ™š (æœ€å¤šäººæ•°äºº)"
                option.textContent = `${room.name} - Â¥${room.price}/æ™š (æœ€å¤š${room.maxGuests}äºº)`;
                // å°†optionæ·»åŠ åˆ°æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ä¸­
                roomTypeSelect.appendChild(option);
            });
            
            // æ·»åŠ æˆ¿å‹é€‰æ‹©äº‹ä»¶ç›‘å¬å™¨
            // ç›‘å¬æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†çš„changeäº‹ä»¶ï¼Œå½“æˆ¿å‹æ”¹å˜æ—¶è§¦å‘
            roomTypeSelect.addEventListener('change', function() {
                // è·å–é€‰ä¸­çš„æˆ¿å‹ID
                const selectedRoomId = this.value;
                // åˆ¤æ–­æ˜¯å¦é€‰æ‹©äº†æˆ¿å‹
                if (selectedRoomId) {
                    // å¦‚æœé€‰æ‹©äº†æˆ¿å‹ï¼Œä»roomTypesæ•°ç»„ä¸­æŸ¥æ‰¾å¯¹åº”çš„æˆ¿å‹æ•°æ®
                    const selectedRoom = roomTypes.find(room => room.id == selectedRoomId);
                    // åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°æˆ¿å‹æ•°æ®
                    if (selectedRoom) {
                        // æ£€æŸ¥æˆ¿å‹æ˜¯å¦æ»¡äººï¼ˆfull=1è¡¨ç¤ºæ»¡äººï¼‰
                        const isFull = selectedRoom.full === 1 || selectedRoom.full === '1' || selectedRoom.full === true || selectedRoom.full === 'true';
                        
                        // å¦‚æœæˆ¿å‹æ»¡äººï¼Œæ˜¾ç¤ºæç¤ºå¹¶é˜»æ­¢é€‰æ‹©
                        if (isFull) {
                            window.alert('è¯¥æˆ¿å‹å·²ç»æ»¡äººï¼Œä¸å¯é€‰æ‹©ï¼');
                            // é‡ç½®é€‰æ‹©ä¸ºç©º
                            this.value = '';
                            // æ¸…ç©ºéšè—å­—æ®µ
                            document.getElementById('bookRoomId').value = '';
                            document.getElementById('bookRoomName').value = '';
                            document.getElementById('bookRoomPrice').value = '';
                            return; // é˜»æ­¢ç»§ç»­æ‰§è¡Œ
                        }
                        
                        // å¦‚æœæ‰¾åˆ°æˆ¿å‹æ•°æ®ï¼Œè®¾ç½®éšè—å­—æ®µçš„å€¼
                        // è®¾ç½®éšè—å­—æ®µbookRoomIdçš„å€¼
                        document.getElementById('bookRoomId').value = selectedRoom.id;
                        // è®¾ç½®éšè—å­—æ®µbookRoomNameçš„å€¼
                        document.getElementById('bookRoomName').value = selectedRoom.name;
                        // è®¾ç½®éšè—å­—æ®µbookRoomPriceçš„å€¼
                        document.getElementById('bookRoomPrice').value = selectedRoom.price;
                        
                        // æ›´æ–°è®¢å•æ‘˜è¦ - ç›´æ¥åœ¨è¿™é‡Œæ›´æ–°ï¼Œä¸è°ƒç”¨å¤–éƒ¨å‡½æ•°
                        // è°ƒç”¨updateOrderSummaryDirectlyå‡½æ•°ï¼Œç›´æ¥æ›´æ–°è®¢å•æ‘˜è¦
                        updateOrderSummaryDirectly(selectedRoom);
                    }
                }
            });
            
            /**
             * ç›´æ¥æ›´æ–°è®¢å•æ‘˜è¦çš„å‡½æ•°
             * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®é€‰ä¸­çš„æˆ¿å‹æ•°æ®ï¼Œç›´æ¥æ›´æ–°è®¢å•æ‘˜è¦ä¿¡æ¯ï¼ˆä¸è°ƒç”¨å¤–éƒ¨updateSummaryå‡½æ•°ï¼‰
             * @param {Object} roomData - æˆ¿å‹æ•°æ®å¯¹è±¡ï¼ŒåŒ…å«idã€nameã€priceç­‰å±æ€§
             */
            function updateOrderSummaryDirectly(roomData) {
                // è·å–å…¥ä½æ—¥æœŸå¯¹è±¡
                const checkIn = new Date(document.getElementById('checkInDate').value);
                // è·å–ç¦»åº—æ—¥æœŸå¯¹è±¡
                const checkOut = new Date(document.getElementById('checkOutDate').value);
                // è·å–é€‰ä¸­çš„å…¥ä½äººæ•°
                const selectedGuests = document.getElementById('guests').value;
                
                // æ›´æ–°å…¥ä½äººæ•°æ˜¾ç¤º
                // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å…¥ä½äººæ•°æ˜¾ç¤ºæ–‡æœ¬
                document.getElementById('summaryGuests').textContent = selectedGuests + 'äºº';
                
                // åˆ¤æ–­å…¥ä½æ—¥æœŸå’Œç¦»åº—æ—¥æœŸæ˜¯å¦æœ‰æ•ˆï¼Œä¸”ç¦»åº—æ—¥æœŸæ™šäºå…¥ä½æ—¥æœŸ
                if (checkIn && checkOut && checkOut > checkIn) {
                    // è®¡ç®—å…¥ä½å¤©æ•°ï¼ˆä½¿ç”¨Math.ceilå‘ä¸Šå–æ•´ï¼‰
                    const days = Math.ceil((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                    // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å…¥ä½å¤©æ•°æ˜¾ç¤ºæ–‡æœ¬
                    document.getElementById('summaryDays').textContent = days + 'æ™š';
                    
                    // åˆ¤æ–­æˆ¿å‹æ•°æ®æ˜¯å¦å­˜åœ¨
                    if (roomData) {
                        // å¦‚æœæˆ¿å‹æ•°æ®å­˜åœ¨ï¼Œæ›´æ–°è®¢å•æ‘˜è¦ä¸­çš„æˆ¿å‹åç§°
                        document.getElementById('summaryRoomName').textContent = roomData.name;
                        // æ›´æ–°è®¢å•æ‘˜è¦ä¸­çš„å•ä»·æ˜¾ç¤ºæ–‡æœ¬
                        document.getElementById('summaryPrice').textContent = 'Â¥' + roomData.price + '/æ™š';
                        
                        // è®¡ç®—æ€»ä»·ï¼ˆå…¥ä½å¤©æ•°ä¹˜ä»¥æˆ¿å‹å•ä»·ï¼‰
                        const total = days * roomData.price;
                        // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æ€»ä»·æ˜¾ç¤ºæ–‡æœ¬
                        document.getElementById('summaryTotal').textContent = 'Â¥' + total;
                        // è®¾ç½®éšè—å­—æ®µbookTotalPriceçš„å€¼ï¼ˆç”¨äºè¡¨å•æäº¤ï¼‰
                        document.getElementById('bookTotalPrice').value = total;
                    }
                // å¦‚æœæ—¥æœŸæ— æ•ˆ
                } else {
                    // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æˆ¿å‹åç§°ä¸º"è¯·é€‰æ‹©æˆ¿å‹"
                    document.getElementById('summaryRoomName').textContent = 'è¯·é€‰æ‹©æˆ¿å‹';
                    // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„å•ä»·æ˜¾ç¤ºä¸º"Â¥0/æ™š"
                    document.getElementById('summaryPrice').textContent = 'Â¥0/æ™š';
                    // è®¾ç½®è®¢å•æ‘˜è¦ä¸­çš„æ€»ä»·æ˜¾ç¤ºä¸º"Â¥0"
                    document.getElementById('summaryTotal').textContent = 'Â¥0';
                    // è®¾ç½®éšè—å­—æ®µbookTotalPriceçš„å€¼ä¸º0
                    document.getElementById('bookTotalPrice').value = 0;
                }
            }
        }
        
        /**
         * æ˜¾ç¤ºæ— æˆ¿å‹æ•°æ®æç¤º
         * åŠŸèƒ½æ¦‚è¿°ï¼šå½“æ— æ³•è·å–æˆ¿å‹æ•°æ®æ—¶ï¼Œæ˜¾ç¤º"æš‚æ— å¯ç”¨æˆ¿å‹"æç¤ºï¼Œå¹¶ç¦ç”¨æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†
         */
        function showNoRoomMessage() {
            // è·å–æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†å…ƒç´ 
            const roomTypeSelect = document.getElementById('roomType');
            // æ¸…ç©ºæˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ï¼Œå¹¶æ·»åŠ "æš‚æ— å¯ç”¨æˆ¿å‹"é€‰é¡¹
            roomTypeSelect.innerHTML = '<option value="">æš‚æ— å¯ç”¨æˆ¿å‹</option>';
            // ç¦ç”¨æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ï¼Œé˜²æ­¢ç”¨æˆ·é€‰æ‹©
            roomTypeSelect.disabled = true;
        }
        
        /**
         * ä»æ•°æ®åº“è·å–æˆ¿å‹æ•°æ®
         * åŠŸèƒ½æ¦‚è¿°ï¼šè°ƒç”¨åç«¯APIæ¥å£ï¼Œä»æ•°æ®åº“è·å–æŒ‡å®šé…’åº—çš„æˆ¿å‹æ•°æ®
         * @param {String} hotelId - é…’åº—ID
         */
        function loadRoomTypesFromDatabase(hotelId) {
            // ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„APIæ¥å£
            // ä½¿ç”¨fetch APIå‘é€GETè¯·æ±‚åˆ°åç«¯æˆ¿å‹APIæ¥å£
            fetch(`/hc/api/rooms/${hotelId}`)
                .then(response => response.json())  // å°†å“åº”è½¬æ¢ä¸ºJSONå¯¹è±¡
                .then(data => {
                    // æ‰“å°ä»APIè·å–çš„æˆ¿å‹æ•°æ®åˆ°æ§åˆ¶å°ï¼Œç”¨äºè°ƒè¯•
                    console.log('ä»APIè·å–çš„æˆ¿å‹æ•°æ®:', data);
                    // åˆ¤æ–­APIè¿”å›çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆï¼Œä¸”åŒ…å«æˆ¿å‹åˆ—è¡¨
                    if (data && data.length > 0 && data[0].rList) {
                        // å¦‚æœæ•°æ®æœ‰æ•ˆï¼Œå°†æˆ¿å‹åˆ—è¡¨è½¬æ¢ä¸ºroomTypesæ•°ç»„æ ¼å¼
                        roomTypes = data[0].rList.map(room => ({
                            id: room.id,  // æˆ¿å‹ID
                            name: room.name,  // æˆ¿å‹åç§°
                            price: room.price,  // æˆ¿å‹ä»·æ ¼
                            maxGuests: 4,  // é»˜è®¤æœ€å¤§äººæ•°ï¼Œå®é™…åº”è¯¥ä»æ•°æ®åº“è·å–
                            amenities: room.content || 'æ ‡å‡†è®¾æ–½',  // æˆ¿å‹è®¾æ–½ï¼ˆå¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨"æ ‡å‡†è®¾æ–½"ï¼‰
                            full: room.full || 0  // æˆ¿å‹æ˜¯å¦æ»¡äººï¼ˆ0=æœªæ»¡äººï¼Œ1=å·²æ»¡äººï¼‰
                        }));
                        // å¡«å……æˆ¿å‹é€‰æ‹©ä¸‹æ‹‰æ¡†
                        populateRoomSelect();
                    // å¦‚æœAPIè¿”å›çš„æ•°æ®ä¸ºç©º
                    } else {
                        // æ‰“å°è­¦å‘Šä¿¡æ¯åˆ°æ§åˆ¶å°
                        console.warn('APIè¿”å›çš„æˆ¿å‹æ•°æ®ä¸ºç©º');
                        // æ˜¾ç¤ºæ— æˆ¿å‹æ•°æ®æç¤º
                        showNoRoomMessage();
                    }
                })
                .catch(error => {
                    // å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
                    console.error('ä»APIè·å–æˆ¿å‹æ•°æ®å¤±è´¥:', error);
                    // æ˜¾ç¤ºæ— æˆ¿å‹æ•°æ®æç¤º
                    showNoRoomMessage();
                });
        }
        
        /**
         * è·å–æˆ¿å‹æ•°æ®
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®æˆ¿å‹IDä»roomTypesæ•°ç»„ä¸­æŸ¥æ‰¾å¯¹åº”çš„æˆ¿å‹æ•°æ®
         * @param {String|Number} roomId - æˆ¿å‹ID
         * @return {Object|undefined} æˆ¿å‹æ•°æ®å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›undefined
         */
        function getRoomData(roomId) {
            // ä»roomTypesæ•°ç»„ä¸­æŸ¥æ‰¾idç­‰äºroomIdçš„æˆ¿å‹æ•°æ®
            return roomTypes.find(room => room.id == roomId);
        }
        
        // ==================== å…¥ä½äººæ•°éªŒè¯åŠŸèƒ½æ¨¡å— ====================
        /**
         * éªŒè¯å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹é™åˆ¶
         * åŠŸèƒ½æ¦‚è¿°ï¼šéªŒè¯é€‰ä¸­çš„å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹çš„æœ€å¤§å…¥ä½äººæ•°é™åˆ¶ï¼Œå¦‚æœè¶…è¿‡åˆ™æç¤ºç”¨æˆ·å¹¶è‡ªåŠ¨è°ƒæ•´
         */
        function validateGuestCount() {
            // è·å–é€‰ä¸­çš„æˆ¿å‹ID
            const selectedRoom = document.getElementById('roomType').value;
            // è·å–é€‰ä¸­çš„å…¥ä½äººæ•°ï¼ˆè½¬æ¢ä¸ºæ•´æ•°ï¼‰
            const selectedGuests = parseInt(document.getElementById('guests').value);
            
            // åˆ¤æ–­æ˜¯å¦é€‰æ‹©äº†æˆ¿å‹
            if (selectedRoom) {
                // å¦‚æœé€‰æ‹©äº†æˆ¿å‹ï¼Œè·å–æˆ¿å‹æ•°æ®
                const roomData = getRoomData(selectedRoom);
                // åˆ¤æ–­æˆ¿å‹æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œä¸”å…¥ä½äººæ•°æ˜¯å¦è¶…è¿‡æˆ¿å‹çš„æœ€å¤§å…¥ä½äººæ•°
                if (roomData && selectedGuests > roomData.maxGuests) {
                    // å¦‚æœå…¥ä½äººæ•°è¶…è¿‡æˆ¿å‹çš„æœ€å¤§å…¥ä½äººæ•°ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    alert(`è¯¥æˆ¿å‹æœ€å¤šåªèƒ½å…¥ä½${roomData.maxGuests}äººï¼Œè¯·é‡æ–°é€‰æ‹©æˆ¿å‹æˆ–è°ƒæ•´å…¥ä½äººæ•°ã€‚`);
                    // è‡ªåŠ¨å°†å…¥ä½äººæ•°è°ƒæ•´ä¸ºæˆ¿å‹çš„æœ€å¤§å…¥ä½äººæ•°
                    document.getElementById('guests').value = roomData.maxGuests;
                    // æ›´æ–°è®¢å•æ‘˜è¦
                    updateSummary();
                }
            }
        }

        // ==================== å®¢æˆ·è¯„ä»·åŠŸèƒ½æ¨¡å— ====================
        /**
         * æ¸²æŸ“æ˜Ÿçº§è¯„åˆ†
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®è¯„åˆ†å€¼æ¸²æŸ“æ˜Ÿçº§æ˜¾ç¤º
         */
        function renderStarRating(element, rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let starsHtml = '';
            for (let i = 0; i < fullStars; i++) {
                starsHtml += '<i class="fas fa-star" style="color: #FFD700;"></i>';
            }
            if (hasHalfStar) {
                starsHtml += '<i class="fas fa-star-half-alt" style="color: #FFD700;"></i>';
            }
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                starsHtml += '<i class="far fa-star" style="color: #FFD700;"></i>';
            }
            element.innerHTML = starsHtml;
        }
        
        /**
         * æ¸²æŸ“æ‰€æœ‰è¯„è®ºçš„æ˜Ÿçº§
         * åŠŸèƒ½æ¦‚è¿°ï¼šéå†æ‰€æœ‰è¯„è®ºå…ƒç´ ï¼Œæ¸²æŸ“æ˜Ÿçº§æ˜¾ç¤º
         */
        function renderAllReviewRatings() {
            document.querySelectorAll('.review-rating[data-rating]').forEach(element => {
                const rating = parseFloat(element.getAttribute('data-rating'));
                if (!isNaN(rating)) {
                    renderStarRating(element, rating);
                }
            });
        }
        
        /**
         * æ¸²æŸ“é…’åº—è¯„åˆ†æ˜Ÿçº§
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®é…’åº—è¯„åˆ†æ¸²æŸ“æ˜Ÿçº§æ˜¾ç¤º
         */
        function renderHotelRating() {
            const ratingScore = document.getElementById('ratingScore');
            const ratingStars = document.getElementById('ratingStars');
            if (ratingScore && ratingStars) {
                const scoreText = ratingScore.textContent.replace('åˆ†', '').trim();
                const score = parseFloat(scoreText);
                if (!isNaN(score)) {
                    renderStarRating(ratingStars, score);
                }
            }
            
            // æ¸²æŸ“è¯„åˆ†æ‘˜è¦åŒºåŸŸçš„æ˜Ÿçº§
            const ratingStarsSummary = document.getElementById('ratingStarsSummary');
            if (ratingStarsSummary) {
                const overallRating = document.querySelector('.overall-rating');
                if (overallRating) {
                    const score = parseFloat(overallRating.textContent);
                    if (!isNaN(score)) {
                        renderStarRating(ratingStarsSummary, score);
                    }
                }
            }
        }
        
        /**
         * è¯„ä»·ç­›é€‰åŠŸèƒ½
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®é€‰æ‹©çš„è¯„åˆ†ç­›é€‰è¯„ä»·åˆ—è¡¨
         */
        function initReviewFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            const reviewItems = document.querySelectorAll('.review-item');
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
                    filterBtns.forEach(b => b.classList.remove('active'));
                    // ä¸ºå½“å‰æŒ‰é’®æ·»åŠ activeç±»
                    this.classList.add('active');
                    
                    const rating = this.getAttribute('data-rating');
                    
                    // ç­›é€‰è¯„ä»·
                    reviewItems.forEach(item => {
                        if (rating === 'all') {
                            item.style.display = 'block';
                        } else {
                            const itemRating = Math.floor(parseFloat(item.getAttribute('data-rating')));
                            if (itemRating == rating) {
                                item.style.display = 'block';
                            } else {
                                item.style.display = 'none';
                            }
                        }
                    });
                });
            });
        }
        
        /**
         * æ˜¾ç¤ºæ·»åŠ è¯„è®ºå¼¹çª—
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ˜¾ç¤ºæ·»åŠ è¯„è®ºçš„å¼¹çª—
         */
        function showAddReviewModal() {
            const modal = document.getElementById('reviewModal');
            if (modal) {
                modal.style.display = 'block';
                // åˆå§‹åŒ–æ˜Ÿçº§é€‰æ‹©äº¤äº’ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå·²æ¸²æŸ“ï¼‰
                setTimeout(function() {
                    initStarRating();
                }, 100);
            }
        }
        
        /**
         * éšè—æ·»åŠ è¯„è®ºå¼¹çª—
         * åŠŸèƒ½æ¦‚è¿°ï¼šéšè—æ·»åŠ è¯„è®ºçš„å¼¹çª—
         */
        function hideAddReviewModal() {
            const modal = document.getElementById('reviewModal');
            if (modal) {
                modal.style.display = 'none';
                document.getElementById('reviewForm').reset();
                // é‡ç½®æ˜Ÿçº§æ˜¾ç¤º
                resetStarRating();
            }
        }
        
        /**
         * åˆå§‹åŒ–æ˜Ÿçº§é€‰æ‹©äº¤äº’
         * åŠŸèƒ½æ¦‚è¿°ï¼šä¸ºæ˜Ÿçº§é€‰æ‹©æ·»åŠ é¼ æ ‡æ‚¬åœå’Œç‚¹å‡»äº¤äº’æ•ˆæœ
         */
        function initStarRating() {
            const starLabels = document.querySelectorAll('.star-rating label.star');
            const starInputs = document.querySelectorAll('.star-rating input[type="radio"]');
            
            if (starLabels.length === 0) return;
            
            // ä¸ºæ¯ä¸ªæ˜Ÿçº§æ ‡ç­¾æ·»åŠ äº‹ä»¶
            starLabels.forEach((label, index) => {
                const starIndex = 5 - index; // ä»5æ˜Ÿåˆ°1æ˜Ÿ
                const input = document.getElementById(`star${starIndex}`);
                
                // é¼ æ ‡æ‚¬åœæ•ˆæœ
                label.addEventListener('mouseenter', function() {
                    highlightStars(starIndex);
                });
                
                // é¼ æ ‡ç¦»å¼€æ•ˆæœ
                label.addEventListener('mouseleave', function() {
                    const checked = document.querySelector('.star-rating input[type="radio"]:checked');
                    if (checked) {
                        const checkedValue = parseInt(checked.value);
                        highlightStars(checkedValue);
                    } else {
                        resetStarRating();
                    }
                });
                
                // ç‚¹å‡»é€‰æ‹©
                label.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    // å–æ¶ˆæ‰€æœ‰radioçš„é€‰ä¸­çŠ¶æ€
                    starInputs.forEach(inp => {
                        if (inp) inp.checked = false;
                    });
                    // é€‰ä¸­å½“å‰radio
                    if (input) {
                        input.checked = true;
                        highlightStars(starIndex);
                        console.log('é€‰ä¸­è¯„åˆ†:', starIndex);
                    }
                });
            });
        }
        
        /**
         * é«˜äº®æ˜¾ç¤ºæ˜Ÿçº§
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®é€‰ä¸­çš„æ˜Ÿçº§æ•°é‡ï¼Œé«˜äº®æ˜¾ç¤ºå¯¹åº”çš„æ˜Ÿæ˜Ÿ
         * @param {number} rating - æ˜Ÿçº§æ•°é‡ï¼ˆ1-5ï¼‰
         */
        function highlightStars(rating) {
            const starLabels = document.querySelectorAll('.star-rating label.star');
            const selectedRatingSpan = document.getElementById('selectedRating');
            
            starLabels.forEach((label, index) => {
                const starIndex = 5 - index; // ä»5æ˜Ÿåˆ°1æ˜Ÿ
                if (starIndex <= rating) {
                    label.style.color = '#FFD700'; // é‡‘è‰²
                    label.style.transform = 'scale(1.1)'; // ç¨å¾®æ”¾å¤§
                } else {
                    label.style.color = '#ddd'; // ç°è‰²
                    label.style.transform = 'scale(1)'; // æ¢å¤åŸå¤§å°
                }
            });
            
            // æ›´æ–°æ˜¾ç¤ºçš„è¯„åˆ†æ–‡å­—
            if (selectedRatingSpan) {
                selectedRatingSpan.textContent = rating + 'åˆ†';
            }
        }
        
        /**
         * é‡ç½®æ˜Ÿçº§æ˜¾ç¤º
         * åŠŸèƒ½æ¦‚è¿°ï¼šå°†æ‰€æœ‰æ˜Ÿæ˜Ÿé‡ç½®ä¸ºç°è‰²
         */
        function resetStarRating() {
            const starLabels = document.querySelectorAll('.star-rating label.star');
            const selectedRatingSpan = document.getElementById('selectedRating');
            
            starLabels.forEach(label => {
                label.style.color = '#ddd';
                label.style.transform = 'scale(1)';
            });
            
            // æ¸…ç©ºæ˜¾ç¤ºçš„è¯„åˆ†æ–‡å­—
            if (selectedRatingSpan) {
                selectedRatingSpan.textContent = '';
            }
        }
        
        /**
         * æäº¤è¯„è®º
         * åŠŸèƒ½æ¦‚è¿°ï¼šæäº¤è¯„è®ºåˆ°åç«¯
         */
        function submitReview(event) {
            event.preventDefault();
            const hotelId = document.getElementById('reviewHotelId').value;
            const rating = document.querySelector('input[name="rating"]:checked');
            const content = document.getElementById('reviewContent').value;
            
            if (!rating) {
                alert('è¯·é€‰æ‹©è¯„åˆ†');
                return;
            }
            
            if (!content.trim()) {
                alert('è¯·è¾“å…¥è¯„è®ºå†…å®¹');
                return;
            }
            
            const formData = new FormData();
            formData.append('hotelId', hotelId);
            formData.append('rating', rating.value);
            formData.append('content', content);
            
            fetch('/hc/review/submit', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('è¯„è®ºæäº¤æˆåŠŸï¼');
                    hideAddReviewModal();
                    location.reload(); // é‡æ–°åŠ è½½é¡µé¢ä»¥æ˜¾ç¤ºæ–°è¯„è®º
                } else {
                    alert('è¯„è®ºæäº¤å¤±è´¥ï¼š' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('è¯„è®ºæäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ¸²æŸ“æ‰€æœ‰è¯„è®ºçš„æ˜Ÿçº§
            renderAllReviewRatings();
            // æ¸²æŸ“é…’åº—è¯„åˆ†æ˜Ÿçº§
            renderHotelRating();
            // åˆå§‹åŒ–è¯„ä»·ç­›é€‰åŠŸèƒ½
            initReviewFilters();
            
            // æ·»åŠ è¯„è®ºæŒ‰é’®äº‹ä»¶
            const addReviewBtn = document.getElementById('addReviewBtn');
            if (addReviewBtn) {
                addReviewBtn.addEventListener('click', showAddReviewModal);
            }
            
            // å…³é—­è¯„è®ºå¼¹çª—æŒ‰é’®äº‹ä»¶
            const closeReviewModal = document.getElementById('closeReviewModal');
            if (closeReviewModal) {
                closeReviewModal.addEventListener('click', hideAddReviewModal);
            }
            
            // è¯„è®ºè¡¨å•æäº¤äº‹ä»¶
            const reviewForm = document.getElementById('reviewForm');
            if (reviewForm) {
                reviewForm.addEventListener('submit', submitReview);
            }
        });
    </script>
</body>
</html>