<!--
    æ–‡ä»¶åç§°ï¼šshoppingIndex.html
    æ–‡ä»¶åŠŸèƒ½ï¼šè´­ç‰©æœåŠ¡é¦–é¡µæ¨¡æ¿
    åŠŸèƒ½æ¦‚è¿°ï¼š
        1. æ˜¾ç¤ºå•†å“åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µåŠ è½½
        2. æä¾›å•†å“æœç´¢åŠŸèƒ½ï¼ˆæŒ‰å•†å“åç§°ã€å“ç‰Œã€ç±»åˆ«æœç´¢ï¼‰
        3. æä¾›å•†å“åˆ†ç±»ç­›é€‰åŠŸèƒ½ï¼ˆèŒ¶å¶ã€å®¶å±…ã€æ•°ç é…ä»¶ã€é›¶é£Ÿã€ä¸ç»¸ã€æ–‡åˆ›ã€å…¶ä»–ç­‰ï¼‰
        4. é›†æˆè´­ç‰©è½¦åŠŸèƒ½ï¼ˆæµ®åŠ¨è´­ç‰©è½¦æŒ‰é’®ã€è´­ç‰©è½¦æŠ½å±‰ï¼‰
        5. æ˜¾ç¤ºè´­ç‰©è½¦å•†å“åˆ—è¡¨å’Œæ€»ä»·
        6. æä¾›ç»“ç®—åŠŸèƒ½ï¼ˆè·³è½¬åˆ°ç»“ç®—é¡µé¢ï¼‰
        7. å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒPCç«¯å’Œç§»åŠ¨ç«¯è®¿é—®
    æŠ€æœ¯æ ˆï¼šHTML5 + CSS3 + JavaScript + Thymeleafæ¨¡æ¿å¼•æ“
    ä¾èµ–æ–‡ä»¶ï¼š
        - Font Awesomeå›¾æ ‡åº“ï¼ˆCDNï¼‰
        - /css/navbar.cssï¼ˆå¯¼èˆªæ æ ·å¼ï¼‰
        - /css/shopping-pinduoduo.cssï¼ˆè´­ç‰©é¡µé¢æ ·å¼ï¼‰
        - /js/shop.jsï¼ˆè´­ç‰©è½¦ç›¸å…³åŠŸèƒ½ï¼‰
    ä½œè€…ï¼šæ¸¸å¸‚ç”Ÿæ´»å¼€å‘å›¢é˜Ÿ
    åˆ›å»ºæ—¥æœŸï¼š2024å¹´
    æœ€åæ›´æ–°ï¼š2024å¹´
-->
<!DOCTYPE html>
<!-- HTML5æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªHTML5æ–‡æ¡£ -->
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<!-- 
    HTMLæ ¹å…ƒç´ 
    lang="zh-CN"ï¼šè®¾ç½®é¡µé¢è¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡
    xmlns:th="http://www.thymeleaf.org"ï¼šå£°æ˜Thymeleafå‘½åç©ºé—´ï¼Œç”¨äºæ¨¡æ¿å¼•æ“è¯­æ³•
-->
<head>
    <!-- HTMLæ–‡æ¡£å¤´éƒ¨ï¼ŒåŒ…å«å…ƒæ•°æ®å’Œæ ·å¼è¡¨å¼•ç”¨ -->
    <!-- å­—ç¬¦ç¼–ç å£°æ˜ï¼ŒæŒ‡å®šé¡µé¢ä½¿ç”¨UTF-8ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡ç­‰å¤šè¯­è¨€å­—ç¬¦ -->
    <meta charset="UTF-8">
    <!-- è§†å£å…ƒæ•°æ®ï¼Œè®¾ç½®é¡µé¢åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºæ–¹å¼ï¼Œwidth=device-widthè¡¨ç¤ºå®½åº¦è‡ªé€‚åº”è®¾å¤‡å®½åº¦ï¼Œinitial-scale=1.0è¡¨ç¤ºåˆå§‹ç¼©æ”¾æ¯”ä¾‹ä¸º1.0 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <title>æ¸¸å¸‚ç”Ÿæ´» - è´­ç‰©æœåŠ¡</title>
    <!-- Font Awesomeå›¾æ ‡åº“ï¼ˆCDNï¼‰ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- å¯¼èˆªæ æ ·å¼è¡¨ -->
    <link rel="stylesheet" href="/css/navbar.css">
    <!-- è´­ç‰©é¡µé¢æ ·å¼è¡¨ -->
    <link rel="stylesheet" href="/css/shopping-pinduoduo.css">
    <style>
        /* è´­ç‰©æœåŠ¡æ¨¡å—ä¸ªæ€§åŒ–æ ·å¼ */
        .shopping-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 30px 20px;
        }

        /* è½®æ’­å›¾åŒºåŸŸ */
        .hero-section {
            background: linear-gradient(135deg, #E02E24, #FF4D47);
            color: white;
            padding: 60px 0;
            margin-bottom: 40px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .hero-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            z-index: 1;
        }

        .hero-content {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero-subtitle {
            font-size: 20px;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        /* æœç´¢åŒºåŸŸ */
        .search-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .search-form {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-form .search-input {
            flex: 1;
            min-width: 300px;
            padding: 15px 25px;
            border: 2px solid #e0e0e0;
            border-radius: 50px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-form .search-input:focus {
            border-color: #E02E24;
        }

        .search-form .search-btn {
            background: #E02E24;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-form .search-btn:hover {
            background: #c41e3a;
        }

        /* åˆ†ç±»æ ‡ç­¾åŒºåŸŸè°ƒæ•´ */
        .category-tabs {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
    </style>
</head>

<body>
    <!-- é¡µé¢ä¸»ä½“ -->
    <!-- ç»Ÿä¸€å¯¼èˆªæ  -->
    <!-- é¡µé¢å¤´éƒ¨å¯¼èˆªæ  -->
    <header class="header">
        <!-- å¯¼èˆªæ å®¹å™¨ -->
        <nav class="nav">
            <!-- ç½‘ç«™Logoé“¾æ¥ -->
            <a href="/" class="logo">
                <!-- åŸå¸‚å›¾æ ‡ -->
                <i class="fas fa-city"></i>
                <!-- ç½‘ç«™åç§° -->
                æ¸¸å¸‚ç”Ÿæ´»
            </a>
            <!-- å¯¼èˆªé“¾æ¥åˆ—è¡¨ -->
            <ul class="nav-links">
                <!-- é¦–é¡µå¯¼èˆªé“¾æ¥ -->
                <li><a href="/">é¦–é¡µ</a></li>
                <!-- ä½å®¿æœåŠ¡å¯¼èˆªé“¾æ¥ -->
                <li><a href="/hc/f2">ä½å®¿æœåŠ¡</a></li>
                <!-- å‡ºè¡ŒæœåŠ¡å¯¼èˆªé“¾æ¥ -->
                <li><a href="/travel">å‡ºè¡ŒæœåŠ¡</a></li>
                <!-- ç¾é£ŸæœåŠ¡å¯¼èˆªé“¾æ¥ -->
                <li><a href="/food">ç¾é£ŸæœåŠ¡</a></li>
                <!-- è´­ç‰©æœåŠ¡å¯¼èˆªé“¾æ¥ -->
                <li><a href="/shopping">è´­ç‰©æœåŠ¡</a></li>
                <!-- ç”Ÿæ´»ç¼´è´¹å¯¼èˆªé“¾æ¥ -->
                <li><a href="/payment">ç”Ÿæ´»ç¼´è´¹</a></li>
            </ul>
            <!-- ç”¨æˆ·æ“ä½œåŒºåŸŸ -->
            <div class="user-actions">
                <!-- æœªç™»å½•çŠ¶æ€æ˜¾ç¤º -->
                <!-- ä½¿ç”¨Thymeleafåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœªç™»å½• -->
                <div th:if="${session.user == null}">
                    <!-- ç™»å½•æŒ‰é’®é“¾æ¥ -->
                    <a href="/user/login" class="login-btn">ç™»å½•</a>
                    <!-- æ³¨å†ŒæŒ‰é’®é“¾æ¥ -->
                    <a href="/user/register" class="register-btn">æ³¨å†Œ</a>
                </div>
                <!-- å·²ç™»å½•çŠ¶æ€æ˜¾ç¤º -->
                <!-- ä½¿ç”¨Thymeleafåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½• -->
                <div th:if="${session.user != null}">
                    <!-- æˆ‘çš„è®¢å•é“¾æ¥ï¼ˆç»Ÿä¸€è®¢å•ä¸­å¿ƒï¼‰ -->
                    <a href="/unified-new/orders" style="color: #FF6600; text-decoration: none; font-weight: 500; margin-right: 15px;">
                        <!-- è®¢å•åˆ—è¡¨å›¾æ ‡ -->
                        <i class="fas fa-list-alt"></i>
                        <!-- æˆ‘çš„è®¢å•æ–‡æœ¬ -->
                        æˆ‘çš„è®¢å•
                    </a>
                    <!-- ä¸ªäººä¸­å¿ƒé“¾æ¥ -->
                    <a href="/user/profile" style="color: #00CED1; text-decoration: none; font-weight: 500;">
                        <!-- ç”¨æˆ·å›¾æ ‡ -->
                        <i class="fas fa-user-circle"></i>
                        <!-- ç”¨æˆ·æ˜µç§°æˆ–ç”¨æˆ·åï¼ˆä½¿ç”¨ThymeleafåŠ¨æ€æ˜¾ç¤ºï¼Œä¼˜å…ˆæ˜¾ç¤ºæ˜µç§°ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ˜¾ç¤ºç”¨æˆ·åï¼‰ -->
                        <span th:text="${session.user.nickname ?: session.user.username}">ç”¨æˆ·</span>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <!-- è´­ç‰©æœåŠ¡é¡µé¢ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="shopping-container">
        <!-- è½®æ’­å›¾åŒºåŸŸ -->
        <!-- é¡µé¢å¤´éƒ¨è½®æ’­å›¾åŒºåŸŸï¼ˆhero sectionï¼‰ -->
        <div class="hero-section">
            <!-- èƒŒæ™¯å›¾ç‰‡ï¼ˆä½¿ç”¨å†…è”æ ·å¼è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼‰ -->
            <div class="hero-image" style="background-image: url('/img/shopping-bg.jpg')"></div>
            <!-- è½®æ’­å›¾å†…å®¹åŒºåŸŸ -->
            <div class="hero-content">
                <!-- é¡µé¢ä¸»æ ‡é¢˜ -->
                <h1 class="hero-title">ç²¾å“è´­ç‰©</h1>
                <!-- é¡µé¢å‰¯æ ‡é¢˜ -->
                <p class="hero-subtitle">å‘ç°ä¼˜è´¨å•†å“ï¼Œäº«å—ä¾¿æ·è´­ç‰©ä½“éªŒ</p>
            </div>
        </div>

        <!-- æœç´¢åŒºåŸŸ -->
        <!-- å•†å“æœç´¢åŒºåŸŸ -->
        <div class="search-section">
            <!-- æœç´¢è¡¨å•ï¼ˆæäº¤æ—¶è°ƒç”¨searchProductså‡½æ•°ï¼Œé˜»æ­¢é»˜è®¤æäº¤è¡Œä¸ºï¼‰ -->
            <form class="search-form" onsubmit="searchProducts(event)">
                <!-- æœç´¢è¾“å…¥æ¡†ï¼ˆæ–‡æœ¬ç±»å‹ï¼Œå ä½ç¬¦æç¤ºç”¨æˆ·è¾“å…¥æœç´¢å…³é”®è¯ï¼‰ -->
                <input type="text" class="search-input" placeholder="æœç´¢å•†å“åç§°ã€å“ç‰Œã€ç±»åˆ«..." id="searchKeyword">
                <!-- æœç´¢æŒ‰é’®ï¼ˆæäº¤ç±»å‹ï¼ŒåŒ…å«æœç´¢å›¾æ ‡å’Œæ–‡æœ¬ï¼‰ -->
                <button type="submit" class="search-btn">
                    <!-- æœç´¢å›¾æ ‡ -->
                    <i class="fas fa-search"></i> 
                    <!-- æœç´¢æ–‡æœ¬ -->
                    æœç´¢
                </button>
                <!-- æ˜¾ç¤ºå…¨éƒ¨æŒ‰é’®ï¼ˆç‚¹å‡»æ—¶åŠ è½½æ‰€æœ‰å•†å“ï¼‰ -->
                <button type="button" class="search-btn" onclick="loadAllProducts()" style="background: #6c757d; margin-left: 10px;">
                    <!-- åˆ·æ–°å›¾æ ‡ -->
                    <i class="fas fa-redo"></i> 
                    <!-- æ˜¾ç¤ºå…¨éƒ¨æ–‡æœ¬ -->
                    æ˜¾ç¤ºå…¨éƒ¨
                </button>
            </form>
        </div>

        <!-- åˆ†ç±»æ ‡ç­¾ -->
        <!-- å•†å“åˆ†ç±»ç­›é€‰æ ‡ç­¾åŒºåŸŸ -->
        <div class="category-tabs">
            <!-- å…¨éƒ¨åˆ†ç±»æ ‡ç­¾ï¼ˆé»˜è®¤æ¿€æ´»ï¼‰ -->
            <a href="#" class="category-tab active" data-category="">å…¨éƒ¨</a>
            <!-- èŒ¶å¶åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="èŒ¶å¶">èŒ¶å¶</a>
            <!-- å®¶å±…åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="å®¶å±…">å®¶å±…</a>
            <!-- æ•°ç é…ä»¶åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="æ•°ç é…ä»¶">æ•°ç é…ä»¶</a>
            <!-- é›¶é£Ÿåˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="é›¶é£Ÿ">é›¶é£Ÿ</a>
            <!-- ä¸ç»¸åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="ä¸ç»¸">ä¸ç»¸</a>
            <!-- æ–‡åˆ›åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="æ–‡åˆ›">æ–‡åˆ›</a>
            <!-- å…¶ä»–åˆ†ç±»æ ‡ç­¾ -->
            <a href="#" class="category-tab" data-category="å…¶ä»–">å…¶ä»–</a>
        </div>

        <!-- å•†å“ç½‘æ ¼ -->
        <!-- å•†å“åˆ—è¡¨ç½‘æ ¼å®¹å™¨ï¼ˆå•†å“å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ï¼‰ -->
        <div class="product-grid" id="productList">
            <!-- å•†å“å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <!-- å•†å“åŠ è½½ä¸­æç¤ºåŒºåŸŸï¼ˆåˆå§‹éšè—ï¼‰ -->
        <div class="loading" id="loadingState" style="display: none;">
            <!-- åŠ è½½åŠ¨ç”» -->
            <div class="loading-spinner"></div>
            <!-- åŠ è½½æç¤ºæ–‡æœ¬ -->
            <div>åŠ è½½ä¸­...</div>
        </div>

        <!-- ç©ºçŠ¶æ€ -->
        <!-- æ— å•†å“æç¤ºåŒºåŸŸï¼ˆåˆå§‹éšè—ï¼‰ -->
        <div class="empty-cart" id="emptyState" style="display: none;">
            <!-- ç©ºçŠ¶æ€å›¾æ ‡ -->
            <div class="empty-cart-icon">ğŸ›’</div>
            <!-- ç©ºçŠ¶æ€æç¤ºæ–‡æœ¬ -->
            <div class="empty-cart-text">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å•†å“</div>
            <!-- é‡æ–°åŠ è½½æŒ‰é’®ï¼ˆç‚¹å‡»åä¿æŒå½“å‰åˆ†ç±»é‡æ–°åŠ è½½å•†å“ï¼‰ -->
            <button onclick="reloadCurrentCategory()" class="checkout-btn">é‡æ–°åŠ è½½</button>
        </div>
    </main>

    <!-- æµ®åŠ¨è´­ç‰©è½¦ -->
    <!-- é¡µé¢å³ä¸‹è§’æµ®åŠ¨è´­ç‰©è½¦æŒ‰é’®ï¼ˆç‚¹å‡»åæ‰“å¼€è´­ç‰©è½¦æŠ½å±‰ï¼‰ -->
    <div class="floating-cart" onclick="openCartDrawer()">
        <!-- è´­ç‰©è½¦å›¾æ ‡ -->
        <i class="fas fa-shopping-cart cart-icon"></i>
        <!-- è´­ç‰©è½¦å•†å“æ•°é‡å¾½ç« ï¼ˆé€šè¿‡JavaScriptåŠ¨æ€æ›´æ–°ï¼‰ -->
        <span class="cart-badge" id="cartBadge">0</span>
    </div>

    <!-- è´­ç‰©è½¦æŠ½å±‰ -->
    <!-- è´­ç‰©è½¦ä¾§è¾¹æŠ½å±‰ï¼ˆä»å³ä¾§æ»‘å‡ºï¼‰ -->
    <div class="cart-drawer" id="cartDrawer">
        <!-- æŠ½å±‰é®ç½©å±‚ï¼ˆç‚¹å‡»åå…³é—­è´­ç‰©è½¦æŠ½å±‰ï¼‰ -->
        <div class="drawer-mask" onclick="closeCartDrawer()"></div>
        <!-- æŠ½å±‰å†…å®¹åŒºåŸŸ -->
        <div class="drawer-content">
            <!-- æŠ½å±‰å¤´éƒ¨ -->
            <div class="drawer-header">
                <!-- æŠ½å±‰æ ‡é¢˜ -->
                <div class="drawer-title">è´­ç‰©è½¦</div>
                <!-- å…³é—­æŠ½å±‰æŒ‰é’®ï¼ˆç‚¹å‡»åå…³é—­è´­ç‰©è½¦æŠ½å±‰ï¼‰ -->
                <button class="close-drawer" onclick="closeCartDrawer()">Ã—</button>
            </div>
            <!-- è´­ç‰©è½¦å•†å“åˆ—è¡¨å®¹å™¨ï¼ˆè´­ç‰©è½¦å•†å“å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ï¼‰ -->
            <div class="cart-items" id="cartItems">
                <!-- è´­ç‰©è½¦å•†å“å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
            <!-- æŠ½å±‰åº•éƒ¨ -->
            <div class="cart-footer">
                <!-- è´­ç‰©è½¦æ€»ä»·æ˜¾ç¤ºï¼ˆé€šè¿‡JavaScriptåŠ¨æ€æ›´æ–°ï¼‰ -->
                <div class="cart-total" id="cartTotal">Â¥0.00</div>
                <!-- å»ç»“ç®—æŒ‰é’®ï¼ˆç‚¹å‡»åæ‰“å¼€ç»“ç®—æ¨¡æ€æ¡†ï¼Œåˆå§‹ç¦ç”¨çŠ¶æ€ï¼‰ -->
                <button class="checkout-btn" id="checkoutBtn" onclick="openCheckoutModal()" disabled>å»ç»“ç®—(0)</button>
            </div>
        </div>
    </div>

    <!-- è´­ç‰©è½¦ç›¸å…³åŠŸèƒ½JavaScriptæ–‡ä»¶ -->
    <script src="/js/shop.js"></script>
    <!-- 
        JavaScriptä»£ç å—
        åŠŸèƒ½æ¦‚è¿°ï¼šå®ç°è´­ç‰©æœåŠ¡é¦–é¡µçš„äº¤äº’åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¼èˆªæ¿€æ´»çŠ¶æ€è®¾ç½®ã€å•†å“æœç´¢ã€åˆ†ç±»ç­›é€‰ç­‰
    -->
    <script>
        /**
         * æ–‡ä»¶çº§æ³¨é‡Šï¼šè´­ç‰©æœåŠ¡é¦–é¡µJavaScriptåŠŸèƒ½æ¨¡å—
         * åŠŸèƒ½æ¦‚è¿°ï¼š
         *   1. å¯¼èˆªæ¿€æ´»çŠ¶æ€è®¾ç½®åŠŸèƒ½ï¼ˆæ ¹æ®å½“å‰è·¯å¾„è®¾ç½®å¯¼èˆªé“¾æ¥çš„æ¿€æ´»çŠ¶æ€ï¼‰
         *   2. å•†å“æœç´¢åŠŸèƒ½ï¼ˆæŒ‰å…³é”®è¯æœç´¢å•†å“ï¼‰
         *   3. åˆ†ç±»ç­›é€‰åŠŸèƒ½ï¼ˆæŒ‰å•†å“åˆ†ç±»ç­›é€‰å•†å“ï¼‰
         *   4. é¡µé¢åˆå§‹åŒ–åŠŸèƒ½ï¼ˆç»‘å®šäº‹ä»¶ç›‘å¬å™¨ï¼Œåˆå§‹åŠ è½½å•†å“ï¼‰
         * æ³¨æ„ï¼šå•†å“åŠ è½½ã€è´­ç‰©è½¦æ“ä½œç­‰åŠŸèƒ½åœ¨shop.jsä¸­å®ç°
         */
        
        // ==================== å¯¼èˆªæ¿€æ´»çŠ¶æ€è®¾ç½®åŠŸèƒ½æ¨¡å— ====================
        /**
         * è®¾ç½®å¯¼èˆªæ¿€æ´»çŠ¶æ€
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ ¹æ®å½“å‰é¡µé¢è·¯å¾„ï¼Œè®¾ç½®å¯¼èˆªé“¾æ¥çš„æ¿€æ´»çŠ¶æ€ï¼ˆæ·»åŠ activeç±»ï¼‰
         */
        function setActiveNavItem() {
            // è·å–å½“å‰é¡µé¢è·¯å¾„
            const currentPath = window.location.pathname;
            // è·å–æ‰€æœ‰å¯¼èˆªé“¾æ¥å…ƒç´ 
            const navLinks = document.querySelectorAll('.nav-links a');
            
            // éå†æ‰€æœ‰å¯¼èˆªé“¾æ¥ï¼Œç§»é™¤activeç±»ï¼Œç„¶åæ ¹æ®å½“å‰è·¯å¾„æ·»åŠ activeç±»
            navLinks.forEach(link => {
                // ç§»é™¤å¯¼èˆªé“¾æ¥çš„activeç±»ï¼Œå–æ¶ˆæ¿€æ´»çŠ¶æ€
                link.classList.remove('active');
                // è·å–å¯¼èˆªé“¾æ¥çš„hrefå±æ€§å€¼
                const href = link.getAttribute('href');
                
                // åˆ¤æ–­å½“å‰è·¯å¾„å’Œå¯¼èˆªé“¾æ¥çš„hrefæ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™æ·»åŠ activeç±»
                // åˆ¤æ–­æ˜¯å¦ä¸ºé¦–é¡µï¼ˆå½“å‰è·¯å¾„ä¸º'/'ä¸”hrefä¸º'/'ï¼‰
                if (currentPath === '/' && href === '/') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                // åˆ¤æ–­æ˜¯å¦ä¸ºä½å®¿æœåŠ¡é¡µé¢ï¼ˆå½“å‰è·¯å¾„ä»¥'/hc/'å¼€å¤´ä¸”hrefä¸º'/hc/f2'ï¼‰
                } else if (currentPath.startsWith('/hc/') && href === '/hc/f2') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                // åˆ¤æ–­æ˜¯å¦ä¸ºå‡ºè¡ŒæœåŠ¡é¡µé¢ï¼ˆå½“å‰è·¯å¾„ä»¥'/travel'å¼€å¤´ä¸”hrefä¸º'/travel'ï¼‰
                } else if (currentPath.startsWith('/travel') && href === '/travel') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                // åˆ¤æ–­æ˜¯å¦ä¸ºç¾é£ŸæœåŠ¡é¡µé¢ï¼ˆå½“å‰è·¯å¾„ä»¥'/food'å¼€å¤´ä¸”hrefä¸º'/food'ï¼‰
                } else if (currentPath.startsWith('/food') && href === '/food') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                // åˆ¤æ–­æ˜¯å¦ä¸ºè´­ç‰©æœåŠ¡é¡µé¢ï¼ˆå½“å‰è·¯å¾„ä»¥'/shopping'å¼€å¤´ä¸”hrefä¸º'/shopping'ï¼‰
                } else if (currentPath.startsWith('/shopping') && href === '/shopping') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                // åˆ¤æ–­æ˜¯å¦ä¸ºç”Ÿæ´»ç¼´è´¹é¡µé¢ï¼ˆå½“å‰è·¯å¾„ä»¥'/payment'å¼€å¤´ä¸”hrefä¸º'/payment'ï¼‰
                } else if (currentPath.startsWith('/payment') && href === '/payment') {
                    // å¦‚æœåŒ¹é…ï¼Œæ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                    link.classList.add('active');
                }
            });
        }

        // ==================== å•†å“æœç´¢åŠŸèƒ½æ¨¡å— ====================
        /**
         * æœç´¢å•†å“
         * åŠŸèƒ½æ¦‚è¿°ï¼šè·å–æœç´¢å…³é”®è¯ï¼Œè°ƒç”¨loadProductså‡½æ•°åŠ è½½æœç´¢ç»“æœï¼ˆloadProductså‡½æ•°åœ¨shop.jsä¸­å®šä¹‰ï¼‰
         * @param {Event} e - è¡¨å•æäº¤äº‹ä»¶å¯¹è±¡ï¼ˆå¯é€‰ï¼‰
         */
        function searchProducts(e) {
            // å¦‚æœäº‹ä»¶å¯¹è±¡å­˜åœ¨ï¼Œé˜»æ­¢è¡¨å•é»˜è®¤æäº¤è¡Œä¸º
            if (e) {
                e.preventDefault();
            }
            // è·å–æœç´¢è¾“å…¥æ¡†çš„å€¼ï¼Œå¹¶å»é™¤é¦–å°¾ç©ºæ ¼
            const keyword = document.getElementById('searchKeyword').value.trim();
            // è·å–å½“å‰é€‰ä¸­çš„åˆ†ç±»
            const activeTab = document.querySelector('.category-tab.active');
            const currentCategory = activeTab ? activeTab.getAttribute('data-category') || '' : '';
            // è°ƒç”¨shop.jsä¸­çš„loadProductså‡½æ•°åŠ è½½æœç´¢ç»“æœï¼ˆé¡µç ä¸º1ï¼Œæœç´¢å…³é”®è¯ä¸ºkeywordï¼Œä¿æŒå½“å‰åˆ†ç±»ï¼‰
            loadProducts(1, keyword, currentCategory);
        }

        /**
         * åŠ è½½æ‰€æœ‰å•†å“ï¼ˆé‡ç½®æœç´¢å’Œåˆ†ç±»ï¼‰
         * åŠŸèƒ½æ¦‚è¿°ï¼šé‡ç½®æœç´¢å…³é”®è¯å’Œåˆ†ç±»ï¼ŒåŠ è½½æ‰€æœ‰å•†å“
         */
        function loadAllProducts() {
            // æ¸…ç©ºæœç´¢è¾“å…¥æ¡†
            document.getElementById('searchKeyword').value = '';
            // é‡ç½®åˆ†ç±»æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // æ¿€æ´»"å…¨éƒ¨"åˆ†ç±»æ ‡ç­¾
            const allTab = document.querySelector('.category-tab[data-category=""]');
            if (allTab) {
                allTab.classList.add('active');
            }
            // è°ƒç”¨shop.jsä¸­çš„loadProductså‡½æ•°åŠ è½½æ‰€æœ‰å•†å“ï¼ˆé¡µç ä¸º1ï¼Œæœç´¢å…³é”®è¯ä¸ºç©ºï¼Œåˆ†ç±»ä¸ºç©ºï¼‰
            loadProducts(1, '', '');
        }

        /**
         * é‡æ–°åŠ è½½å½“å‰åˆ†ç±»çš„å•†å“
         * åŠŸèƒ½æ¦‚è¿°ï¼šä¿æŒå½“å‰æœç´¢å…³é”®è¯å’Œåˆ†ç±»ï¼Œé‡æ–°åŠ è½½å•†å“
         */
        function reloadCurrentCategory() {
            // è·å–æœç´¢è¾“å…¥æ¡†çš„å€¼
            const keyword = document.getElementById('searchKeyword').value.trim();
            // è·å–å½“å‰é€‰ä¸­çš„åˆ†ç±»
            const activeTab = document.querySelector('.category-tab.active');
            const currentCategory = activeTab ? activeTab.getAttribute('data-category') || '' : '';
            // è°ƒç”¨shop.jsä¸­çš„loadProductså‡½æ•°é‡æ–°åŠ è½½å•†å“ï¼ˆä¿æŒå½“å‰æœç´¢å…³é”®è¯å’Œåˆ†ç±»ï¼‰
            loadProducts(1, keyword, currentCategory);
        }

        // ==================== åˆ†ç±»ç­›é€‰åŠŸèƒ½æ¨¡å— ====================
        /**
         * æŒ‰åˆ†ç±»ç­›é€‰å•†å“
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ›´æ–°åˆ†ç±»æ ‡ç­¾çš„æ¿€æ´»çŠ¶æ€ï¼Œè°ƒç”¨loadProductså‡½æ•°åŠ è½½å¯¹åº”åˆ†ç±»çš„å•†å“ï¼ˆloadProductså‡½æ•°åœ¨shop.jsä¸­å®šä¹‰ï¼‰
         * @param {Event} e - ç‚¹å‡»äº‹ä»¶å¯¹è±¡ï¼ˆå¯é€‰ï¼‰
         * @param {String} category - å•†å“åˆ†ç±»åç§°ï¼ˆç©ºå­—ç¬¦ä¸²è¡¨ç¤ºå…¨éƒ¨ï¼‰
         */
        function filterByCategory(e, category) {
            // æ›´æ–°åˆ†ç±»æ ‡ç­¾çŠ¶æ€
            // éå†æ‰€æœ‰åˆ†ç±»æ ‡ç­¾ï¼Œç§»é™¤activeç±»ï¼Œå–æ¶ˆæ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // åˆ¤æ–­äº‹ä»¶å¯¹è±¡æ˜¯å¦å­˜åœ¨ä¸”å­˜åœ¨currentTargetå±æ€§
            if (e && e.currentTarget) {
                // å¦‚æœäº‹ä»¶å¯¹è±¡å­˜åœ¨ï¼Œä¸ºå½“å‰ç‚¹å‡»çš„åˆ†ç±»æ ‡ç­¾æ·»åŠ activeç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
                e.currentTarget.classList.add('active');
            }
            
            // åŠ è½½å¯¹åº”åˆ†ç±»çš„å•†å“
            // è°ƒç”¨shop.jsä¸­çš„loadProductså‡½æ•°åŠ è½½å¯¹åº”åˆ†ç±»çš„å•†å“ï¼ˆé¡µç ä¸º1ï¼Œæœç´¢å…³é”®è¯ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ†ç±»ä¸ºcategoryï¼‰
            loadProducts(1, '', category);
        }

        // ==================== é¡µé¢åˆå§‹åŒ–åŠŸèƒ½æ¨¡å— ====================
        /**
         * é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
         * åŠŸèƒ½æ¦‚è¿°ï¼šç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œå½“DOMåŠ è½½å®Œæˆåè®¾ç½®å¯¼èˆªæ¿€æ´»çŠ¶æ€ã€ç»‘å®šæœç´¢å’Œåˆ†ç±»ç­›é€‰äº‹ä»¶ã€åˆå§‹åŠ è½½å•†å“
         */
        // ç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œå½“DOMåŠ è½½å®Œæˆåè§¦å‘
        document.addEventListener('DOMContentLoaded', function() {
            // æ‰“å°è°ƒè¯•ä¿¡æ¯åˆ°æ§åˆ¶å°
            console.log('è´­ç‰©æœåŠ¡é¡µé¢åŠ è½½å®Œæˆ');
            
            // è®¾ç½®å¯¼èˆªæ¿€æ´»çŠ¶æ€
            // è°ƒç”¨setActiveNavItemå‡½æ•°ï¼Œæ ¹æ®å½“å‰è·¯å¾„è®¾ç½®å¯¼èˆªé“¾æ¥çš„æ¿€æ´»çŠ¶æ€
            setActiveNavItem();
            
            // ç»‘å®šæœç´¢äº‹ä»¶
            // è·å–æœç´¢è¾“å…¥æ¡†å…ƒç´ ï¼Œä¸ºå…¶ç»‘å®škeypressäº‹ä»¶ç›‘å¬å™¨
            document.getElementById('searchKeyword').addEventListener('keypress', function(e) {
                // åˆ¤æ–­æŒ‰ä¸‹çš„é”®æ˜¯å¦ä¸ºEnteré”®
                if (e.key === 'Enter') {
                    // å¦‚æœæŒ‰ä¸‹Enteré”®ï¼Œè°ƒç”¨searchProductså‡½æ•°æ‰§è¡Œæœç´¢
                    searchProducts();
                }
            });
            
            // ç»‘å®šåˆ†ç±»æ ‡ç­¾äº‹ä»¶
            // éå†æ‰€æœ‰åˆ†ç±»æ ‡ç­¾ï¼Œä¸ºæ¯ä¸ªæ ‡ç­¾ç»‘å®šclickäº‹ä»¶ç›‘å¬å™¨
            document.querySelectorAll('.category-tab').forEach(tab => {
                // ç›‘å¬åˆ†ç±»æ ‡ç­¾çš„clickäº‹ä»¶ï¼Œå½“ç‚¹å‡»æ ‡ç­¾æ—¶è§¦å‘
                tab.addEventListener('click', function(e) {
                    // é˜»æ­¢æ ‡ç­¾çš„é»˜è®¤è¡Œä¸ºï¼ˆé¡µé¢è·³è½¬ï¼‰
                    e.preventDefault();
                    // è·å–æ ‡ç­¾çš„data-categoryå±æ€§å€¼ï¼ˆåˆ†ç±»åç§°ï¼‰
                    const category = this.getAttribute('data-category');
                    // è°ƒç”¨filterByCategoryå‡½æ•°ï¼ŒæŒ‰åˆ†ç±»ç­›é€‰å•†å“
                    filterByCategory(e, category);
                });
            });
            
            // åˆå§‹åŠ è½½å•†å“
            // è°ƒç”¨shop.jsä¸­çš„loadProductså‡½æ•°ï¼Œåˆå§‹åŠ è½½å•†å“åˆ—è¡¨ï¼ˆä¸ä¼ é€’å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤å€¼ï¼‰
            loadProducts();
        });
    </script>
    
</body>
</html>
