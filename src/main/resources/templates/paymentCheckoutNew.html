<!--
    æ–‡ä»¶åç§°ï¼špaymentCheckoutNew.html
    æ–‡ä»¶åŠŸèƒ½ï¼šç»Ÿä¸€æ”¯ä»˜é¡µé¢æ¨¡æ¿
    åŠŸèƒ½æ¦‚è¿°ï¼š
        1. æ˜¾ç¤ºè®¢å•è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¢å•å·ã€è®¢å•ç±»å‹ã€è®¢å•æ ‡é¢˜ã€è®¢å•çŠ¶æ€ã€åˆ›å»ºæ—¶é—´ç­‰
        2. æ ¹æ®è®¢å•ç±»å‹ï¼ˆè´­ç‰©ã€ç¾é£Ÿã€é…’åº—ï¼‰åŠ¨æ€æ˜¾ç¤ºä¸åŒçš„è®¢å•è¯¦æƒ…ï¼ˆå•†å“åˆ—è¡¨ã€èœå“åˆ—è¡¨ã€é¢„è®¢è¯¦æƒ…ï¼‰
        3. æä¾›å¤šç§æ”¯ä»˜æ–¹å¼é€‰æ‹©ï¼ˆå¾®ä¿¡æ”¯ä»˜ã€æ”¯ä»˜å®ã€é“¶è¡Œå¡ï¼‰
        4. å¤„ç†æ”¯ä»˜è¯·æ±‚ï¼Œå‘é€æ”¯ä»˜è¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†æ”¯ä»˜ç»“æœå¹¶è·³è½¬
        5. æ ¹æ®æ¥æºé¡µé¢æ™ºèƒ½è·³è½¬ï¼ˆæ”¯ä»˜æˆåŠŸåè¿”å›åˆ°æ¥æºé¡µé¢æˆ–è®¢å•ä¸­å¿ƒï¼‰
        6. å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒPCç«¯å’Œç§»åŠ¨ç«¯è®¿é—®
    æŠ€æœ¯æ ˆï¼šHTML5 + CSS3 + JavaScript + Thymeleafæ¨¡æ¿å¼•æ“
    ä¾èµ–æ–‡ä»¶ï¼šæ— å¤–éƒ¨JavaScriptæ–‡ä»¶ä¾èµ–
    ä½œè€…ï¼šæ¸¸å¸‚ç”Ÿæ´»å¼€å‘å›¢é˜Ÿ
    åˆ›å»ºæ—¥æœŸï¼š2024å¹´
    æœ€åæ›´æ–°ï¼š2024å¹´
-->
<!DOCTYPE html>
<!-- HTML5æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªHTML5æ–‡æ¡£ -->
<html xmlns:th="http://www.thymeleaf.org">
<!-- 
    HTMLæ ¹å…ƒç´ 
    xmlns:th="http://www.thymeleaf.org"ï¼šå£°æ˜Thymeleafå‘½åç©ºé—´ï¼Œç”¨äºæ¨¡æ¿å¼•æ“è¯­æ³•
-->
<head>
    <!-- HTMLæ–‡æ¡£å¤´éƒ¨ï¼ŒåŒ…å«å…ƒæ•°æ®å’Œæ ·å¼è¡¨å¼•ç”¨ -->
    <!-- å­—ç¬¦ç¼–ç å£°æ˜ï¼ŒæŒ‡å®šé¡µé¢ä½¿ç”¨UTF-8ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡ç­‰å¤šè¯­è¨€å­—ç¬¦ -->
    <meta charset="UTF-8">
    <!-- è§†å£å…ƒæ•°æ®ï¼Œè®¾ç½®é¡µé¢åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºæ–¹å¼ï¼Œwidth=device-widthè¡¨ç¤ºå®½åº¦è‡ªé€‚åº”è®¾å¤‡å®½åº¦ï¼Œinitial-scale=1.0è¡¨ç¤ºåˆå§‹ç¼©æ”¾æ¯”ä¾‹ä¸º1.0 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <title>ç»Ÿä¸€æ”¯ä»˜ - è¥¿æ¹–æ—…æ¸¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            padding-bottom: 80px; /* ä¸ºåº•éƒ¨ç•™å‡ºç©ºé—´ */
        }

        .payment-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .payment-header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .payment-header h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .payment-header p {
            color: #7f8c8d;
            font-size: 16px;
        }

        .payment-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .order-info {
            padding: 30px;
            border-bottom: 1px solid #eee;
        }

        .order-info h2 {
            font-size: 20px;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .order-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .order-detail.full-width {
            grid-column: 1 / -1;
        }

        .order-detail {
            display: flex;
            flex-direction: column;
        }

        .order-detail label {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .order-detail span {
            font-size: 16px;
            color: #2c3e50;
            font-weight: 500;
        }

        .order-amount {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .order-amount .label {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .order-amount .amount {
            font-size: 32px;
            font-weight: 700;
            color: #e74c3c;
        }

        .payment-methods {
            padding: 30px;
        }

        .payment-methods h2 {
            font-size: 20px;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .payment-option {
            border: 2px solid #eee;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .payment-option:hover {
            border-color: #007bff;
            background: #f8f9fa;
        }

        .payment-option.selected {
            border-color: #007bff;
            background: #e3f2fd;
        }

        .payment-option input[type="radio"] {
            display: none;
        }

        .payment-option .icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .payment-option .name {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .payment-option .desc {
            font-size: 12px;
            color: #7f8c8d;
        }

        .payment-actions {
            padding: 30px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            min-width: 120px;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        @media (max-width: 768px) {
            .payment-container {
                padding: 10px;
            }

            .order-details {
                grid-template-columns: 1fr;
            }

            .payment-options {
                grid-template-columns: 1fr;
            }

            .payment-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- æ”¯ä»˜é¡µé¢å®¹å™¨ -->
    <div class="payment-container">
        <!-- æ”¯ä»˜é¡µé¢å¤´éƒ¨ -->
        <div class="payment-header">
            <!-- æ”¯ä»˜é¡µé¢æ ‡é¢˜ -->
            <h1>ç»Ÿä¸€æ”¯ä»˜</h1>
            <!-- æ”¯ä»˜é¡µé¢å‰¯æ ‡é¢˜ -->
            <p>å®‰å…¨ä¾¿æ·çš„æ”¯ä»˜ä½“éªŒ</p>
        </div>

        <!-- æ”¯ä»˜å†…å®¹åŒºåŸŸ -->
        <div class="payment-content">
            <!-- è®¢å•ä¿¡æ¯åŒºåŸŸ -->
            <div class="order-info">
                <!-- è®¢å•ä¿¡æ¯æ ‡é¢˜ -->
                <h2>è®¢å•ä¿¡æ¯</h2>
                <!-- è®¢å•è¯¦æƒ…åˆ—è¡¨ -->
                <div class="order-details">
                    <!-- è®¢å•å·è¯¦æƒ…é¡¹ -->
                    <div class="order-detail">
                        <!-- è®¢å•å·æ ‡ç­¾ -->
                        <label>è®¢å•å·</label>
                        <!-- è®¢å•å·å€¼ï¼Œä½¿ç”¨ThymeleafåŠ¨æ€æ˜¾ç¤ºè®¢å•å· -->
                        <span th:text="${order.orderNo}">UOFOOD20251024001</span>
                    </div>
                    <!-- è®¢å•ç±»å‹è¯¦æƒ…é¡¹ -->
                    <div class="order-detail">
                        <!-- è®¢å•ç±»å‹æ ‡ç­¾ -->
                        <label>è®¢å•ç±»å‹</label>
                        <!-- è®¢å•ç±»å‹å€¼ï¼Œä½¿ç”¨Thymeleafè°ƒç”¨getTypeText()æ–¹æ³•è·å–è®¢å•ç±»å‹æ–‡æœ¬ -->
                        <span th:text="${order.getTypeText()}">ç¾é£Ÿå¤–å–</span>
                    </div>
                    <!-- è®¢å•æ ‡é¢˜è¯¦æƒ…é¡¹ -->
                    <div class="order-detail">
                        <!-- è®¢å•æ ‡é¢˜æ ‡ç­¾ -->
                        <label>è®¢å•æ ‡é¢˜</label>
                        <!-- è®¢å•æ ‡é¢˜å€¼ï¼Œä½¿ç”¨ThymeleafåŠ¨æ€æ˜¾ç¤ºè®¢å•æ ‡é¢˜ -->
                        <span th:text="${order.orderTitle}">è¥¿æ¹–æ¥¼å¤–å–è®¢å•</span>
                    </div>
                    <!-- è®¢å•æè¿°è¯¦æƒ…é¡¹ï¼ˆå…¨å®½ï¼Œæ¡ä»¶æ˜¾ç¤ºï¼‰ -->
                    <div class="order-detail full-width" th:if="${order.orderDescription != null and order.orderDescription != ''}">
                        <!-- è®¢å•æè¿°æ ‡ç­¾ -->
                        <label>è®¢å•æè¿°</label>
                        <!-- è®¢å•æè¿°å€¼ï¼Œä½¿ç”¨ThymeleafåŠ¨æ€æ˜¾ç¤ºè®¢å•æè¿°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ -->
                        <span th:text="${order.orderDescription}">è®¢å•æè¿°</span>
                    </div>
                    <!-- è®¢å•çŠ¶æ€è¯¦æƒ…é¡¹ -->
                    <div class="order-detail">
                        <!-- è®¢å•çŠ¶æ€æ ‡ç­¾ -->
                        <label>è®¢å•çŠ¶æ€</label>
                        <!-- è®¢å•çŠ¶æ€å€¼ï¼Œä½¿ç”¨Thymeleafè°ƒç”¨getStatusText()æ–¹æ³•è·å–è®¢å•çŠ¶æ€æ–‡æœ¬ -->
                        <span th:text="${order.getStatusText()}">å¾…æ”¯ä»˜</span>
                    </div>
                    <!-- åˆ›å»ºæ—¶é—´è¯¦æƒ…é¡¹ -->
                    <div class="order-detail">
                        <!-- åˆ›å»ºæ—¶é—´æ ‡ç­¾ -->
                        <label>åˆ›å»ºæ—¶é—´</label>
                        <!-- åˆ›å»ºæ—¶é—´å€¼ï¼Œä½¿ç”¨Thymeleafæ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤ºï¼ˆæ ¼å¼ï¼šyyyy-MM-dd HH:mm:ssï¼‰ -->
                        <span th:text="${#temporals.format(order.createTime, 'yyyy-MM-dd HH:mm:ss')}">2025-01-01 10:00:00</span>
                    </div>
                </div>
                <!-- è®¢å•é‡‘é¢æ˜¾ç¤ºåŒºåŸŸ -->
                <div class="order-amount">
                    <!-- é‡‘é¢æ ‡ç­¾ -->
                    <div class="label">åº”ä»˜é‡‘é¢</div>
                    <!-- é‡‘é¢å€¼ï¼Œä½¿ç”¨Thymeleafæ ¼å¼åŒ–é‡‘é¢æ˜¾ç¤ºï¼ˆå¦‚æœé‡‘é¢ä¸ä¸ºnullåˆ™æ˜¾ç¤ºæ ¼å¼åŒ–åçš„é‡‘é¢ï¼Œå¦åˆ™æ˜¾ç¤ºÂ¥0.00ï¼‰ -->
                    <div class="amount" th:text="${order.totalAmount != null ? 'Â¥' + #numbers.formatDecimal(order.totalAmount, 1, 2) : 'Â¥0.00'}">Â¥89.00</div>
                </div>
                
                <!-- è®¢å•è¯¦æƒ…åˆ—è¡¨ï¼ˆè´­ç‰©è®¢å•æ˜¾ç¤ºå•†å“åˆ—è¡¨ï¼Œç¾é£Ÿè®¢å•æ˜¾ç¤ºèœå“åˆ—è¡¨ï¼Œé…’åº—è®¢å•æ˜¾ç¤ºé¢„è®¢è¯¦æƒ…ï¼‰ -->
                <div th:if="${(detailType == 'SHOPPING' or detailType == 'FOOD' or detailType == 'HOTEL') and orderDetails != null and !orderDetails.isEmpty()}" class="order-items-list" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
                    <h3 style="font-size: 16px; color: #2c3e50; margin-bottom: 15px;" th:text="${detailType == 'SHOPPING' ? 'å•†å“æ¸…å•' : (detailType == 'FOOD' ? 'èœå“æ¸…å•' : 'é¢„è®¢è¯¦æƒ…')}">å•†å“æ¸…å•</h3>
                    <!-- è´­ç‰©å’Œç¾é£Ÿè®¢å•è¯¦æƒ…è¡¨æ ¼ -->
                    <div th:if="${detailType == 'SHOPPING' or detailType == 'FOOD'}" class="items-table" style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #e9ecef;">
                                    <th style="padding: 12px; text-align: left; font-size: 14px; color: #495057; font-weight: 600;" th:text="${detailType == 'SHOPPING' ? 'å•†å“åç§°' : 'èœå“åç§°'}">å•†å“åç§°</th>
                                    <th style="padding: 12px; text-align: center; font-size: 14px; color: #495057; font-weight: 600;">å•ä»·</th>
                                    <th style="padding: 12px; text-align: center; font-size: 14px; color: #495057; font-weight: 600;">æ•°é‡</th>
                                    <th style="padding: 12px; text-align: right; font-size: 14px; color: #495057; font-weight: 600;">å°è®¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- è´­ç‰©è®¢å•å•†å“åˆ—è¡¨ -->
                                <tr th:if="${detailType == 'SHOPPING'}" th:each="item : ${orderDetails}" style="border-bottom: 1px solid #dee2e6;">
                                    <td style="padding: 12px; font-size: 14px; color: #2c3e50;" th:text="${item.productName}">å•†å“åç§°</td>
                                    <td style="padding: 12px; text-align: center; font-size: 14px; color: #495057;" th:text="'Â¥' + ${#numbers.formatDecimal(item.productPrice, 1, 2)}">Â¥0.00</td>
                                    <td style="padding: 12px; text-align: center; font-size: 14px; color: #495057;" th:text="${item.quantity}">1</td>
                                    <td style="padding: 12px; text-align: right; font-size: 14px; color: #e74c3c; font-weight: 600;" th:text="'Â¥' + ${#numbers.formatDecimal(item.subtotal, 1, 2)}">Â¥0.00</td>
                                </tr>
                                <!-- ç¾é£Ÿè®¢å•èœå“åˆ—è¡¨ -->
                                <tr th:if="${detailType == 'FOOD'}" th:each="item : ${orderDetails}" style="border-bottom: 1px solid #dee2e6;">
                                    <td style="padding: 12px; font-size: 14px; color: #2c3e50;" th:text="${item.menuName}">èœå“åç§°</td>
                                    <td style="padding: 12px; text-align: center; font-size: 14px; color: #495057;" th:text="'Â¥' + ${#numbers.formatDecimal(item.menuPrice, 1, 2)}">Â¥0.00</td>
                                    <td style="padding: 12px; text-align: center; font-size: 14px; color: #495057;" th:text="${item.quantity}">1</td>
                                    <td style="padding: 12px; text-align: right; font-size: 14px; color: #e74c3c; font-weight: 600;" th:text="'Â¥' + ${#numbers.formatDecimal(item.subtotal, 1, 2)}">Â¥0.00</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr style="background: #fff;">
                                    <td colspan="3" style="padding: 12px; text-align: right; font-size: 16px; font-weight: 600; color: #2c3e50;">åˆè®¡ï¼š</td>
                                    <td style="padding: 12px; text-align: right; font-size: 18px; font-weight: 700; color: #e74c3c;" th:text="'Â¥' + ${#numbers.formatDecimal(order.totalAmount, 1, 2)}">Â¥0.00</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <!-- é…’åº—è®¢å•è¯¦æƒ…å¡ç‰‡ -->
                    <div th:if="${detailType == 'HOTEL'}" class="hotel-details" style="background: #f8f9fa; border-radius: 8px; padding: 20px;">
                        <div th:each="item : ${orderDetails}" style="background: white; border-radius: 8px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">é…’åº—åç§°</label>
                                    <span style="font-size: 16px; color: #2c3e50; font-weight: 600;" th:text="${item.hotelName}">é…’åº—åç§°</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">æˆ¿å‹</label>
                                    <span style="font-size: 16px; color: #2c3e50; font-weight: 600;" th:text="${item.roomType}">æˆ¿å‹</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">å…¥ä½æ—¥æœŸ</label>
                                    <span style="font-size: 16px; color: #2c3e50;" th:text="${#temporals.format(item.checkInDate, 'yyyy-MM-dd')}">2025-01-01</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">é€€æˆ¿æ—¥æœŸ</label>
                                    <span style="font-size: 16px; color: #2c3e50;" th:text="${#temporals.format(item.checkOutDate, 'yyyy-MM-dd')}">2025-01-02</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">å…¥ä½å¤©æ•°</label>
                                    <span style="font-size: 16px; color: #2c3e50;" th:text="${item.nights + 'æ™š'}">1æ™š</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">å…¥ä½äººæ•°</label>
                                    <span style="font-size: 16px; color: #2c3e50;" th:text="${item.guests + 'äºº'}">2äºº</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">æˆ¿å‹å•ä»·</label>
                                    <span style="font-size: 16px; color: #495057;" th:text="'Â¥' + ${#numbers.formatDecimal(item.roomPrice, 1, 2)} + '/æ™š'">Â¥0.00/æ™š</span>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 5px;">å°è®¡</label>
                                    <span style="font-size: 18px; color: #e74c3c; font-weight: 700;" th:text="'Â¥' + ${#numbers.formatDecimal(item.subtotal, 1, 2)}">Â¥0.00</span>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: right; padding-top: 15px; border-top: 1px solid #dee2e6;">
                            <span style="font-size: 16px; font-weight: 600; color: #2c3e50; margin-right: 10px;">åˆè®¡ï¼š</span>
                            <span style="font-size: 20px; font-weight: 700; color: #e74c3c;" th:text="'Â¥' + ${#numbers.formatDecimal(order.totalAmount, 1, 2)}">Â¥0.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ”¯ä»˜æ–¹å¼é€‰æ‹©åŒºåŸŸ -->
            <div class="payment-methods">
                <!-- æ”¯ä»˜æ–¹å¼æ ‡é¢˜ -->
                <h2>é€‰æ‹©æ”¯ä»˜æ–¹å¼</h2>
                <!-- æ”¯ä»˜æ–¹å¼é€‰é¡¹åˆ—è¡¨ -->
                <div class="payment-options">
                    <!-- å¾®ä¿¡æ”¯ä»˜é€‰é¡¹ -->
                    <label class="payment-option" onclick="selectPaymentMethod('wechat')">
                        <!-- å¾®ä¿¡æ”¯ä»˜å•é€‰æŒ‰é’®ï¼ˆè§†è§‰ä¸Šéšè—ï¼‰ -->
                        <input type="radio" name="paymentMethod" value="wechat">
                        <!-- å¾®ä¿¡æ”¯ä»˜å›¾æ ‡ -->
                        <div class="icon">ğŸ’³</div>
                        <!-- å¾®ä¿¡æ”¯ä»˜åç§° -->
                        <div class="name">å¾®ä¿¡æ”¯ä»˜</div>
                        <!-- å¾®ä¿¡æ”¯ä»˜æè¿° -->
                        <div class="desc">å®‰å…¨ä¾¿æ·</div>
                    </label>
                    <!-- æ”¯ä»˜å®é€‰é¡¹ -->
                    <label class="payment-option" onclick="selectPaymentMethod('alipay')">
                        <!-- æ”¯ä»˜å®å•é€‰æŒ‰é’®ï¼ˆè§†è§‰ä¸Šéšè—ï¼‰ -->
                        <input type="radio" name="paymentMethod" value="alipay">
                        <!-- æ”¯ä»˜å®å›¾æ ‡ -->
                        <div class="icon">ğŸ’°</div>
                        <!-- æ”¯ä»˜å®åç§° -->
                        <div class="name">æ”¯ä»˜å®</div>
                        <!-- æ”¯ä»˜å®æè¿° -->
                        <div class="desc">å¿«é€Ÿæ”¯ä»˜</div>
                    </label>
                    <!-- é“¶è¡Œå¡é€‰é¡¹ -->
                    <label class="payment-option" onclick="selectPaymentMethod('bank')">
                        <!-- é“¶è¡Œå¡å•é€‰æŒ‰é’®ï¼ˆè§†è§‰ä¸Šéšè—ï¼‰ -->
                        <input type="radio" name="paymentMethod" value="bank">
                        <!-- é“¶è¡Œå¡å›¾æ ‡ -->
                        <div class="icon">ğŸ¦</div>
                        <!-- é“¶è¡Œå¡åç§° -->
                        <div class="name">é“¶è¡Œå¡</div>
                        <!-- é“¶è¡Œå¡æè¿° -->
                        <div class="desc">é“¶è¡Œç›´è¿</div>
                    </label>
                </div>
            </div>

            <!-- æ”¯ä»˜æ“ä½œæŒ‰é’®åŒºåŸŸ -->
            <div class="payment-actions">
                <!-- è¿”å›æŒ‰é’®ï¼Œç‚¹å‡»åè¿”å›ä¸Šä¸€é¡µ -->
                <button class="btn btn-secondary" onclick="goBack()">è¿”å›</button>
                <!-- ç¡®è®¤æ”¯ä»˜æŒ‰é’®ï¼Œåˆå§‹çŠ¶æ€ä¸ºç¦ç”¨ï¼Œé€‰æ‹©æ”¯ä»˜æ–¹å¼åå¯ç”¨ -->
                <button class="btn btn-primary" id="payButton" onclick="processPayment()" disabled>
                    ç¡®è®¤æ”¯ä»˜
                </button>
            </div>

            <!-- åŠ è½½æç¤ºåŒºåŸŸ -->
            <div class="loading" id="loading">
                <!-- åŠ è½½æç¤ºæ–‡æœ¬ -->
                <div>å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...</div>
            </div>

            <!-- é”™è¯¯æ¶ˆæ¯åŒºåŸŸ -->
            <div class="error" id="error"></div>
            <!-- æˆåŠŸæ¶ˆæ¯åŒºåŸŸ -->
            <div class="success" id="success"></div>
        </div>
    </div>

    <!-- 
        JavaScriptä»£ç å—
        åŠŸèƒ½æ¦‚è¿°ï¼šå®ç°æ”¯ä»˜é¡µé¢çš„äº¤äº’åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ”¯ä»˜æ–¹å¼é€‰æ‹©ã€æ”¯ä»˜å¤„ç†ã€æ¶ˆæ¯æç¤ºã€é¡µé¢è·³è½¬ç­‰
    -->
    <script>
        /**
         * æ–‡ä»¶çº§æ³¨é‡Šï¼šç»Ÿä¸€æ”¯ä»˜é¡µé¢JavaScriptåŠŸèƒ½æ¨¡å—
         * åŠŸèƒ½æ¦‚è¿°ï¼š
         *   1. æ”¯ä»˜æ–¹å¼é€‰æ‹©åŠŸèƒ½ï¼ˆå¾®ä¿¡æ”¯ä»˜ã€æ”¯ä»˜å®ã€é“¶è¡Œå¡ï¼‰
         *   2. æ”¯ä»˜å¤„ç†åŠŸèƒ½ï¼ˆå‘é€æ”¯ä»˜è¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†æ”¯ä»˜ç»“æœï¼‰
         *   3. æ™ºèƒ½é¡µé¢è·³è½¬åŠŸèƒ½ï¼ˆæ ¹æ®æ¥æºé¡µé¢å†³å®šè·³è½¬ä½ç½®ï¼‰
         *   4. æ¶ˆæ¯æç¤ºåŠŸèƒ½ï¼ˆåŠ è½½çŠ¶æ€ã€é”™è¯¯æ¶ˆæ¯ã€æˆåŠŸæ¶ˆæ¯ï¼‰
         *   5. è®¢å•å·éªŒè¯åŠŸèƒ½ï¼ˆé¡µé¢åŠ è½½æ—¶æ£€æŸ¥è®¢å•å·æ˜¯å¦å­˜åœ¨ï¼‰
         */
        
        // ==================== å…¨å±€å˜é‡ ====================
        /**
         * é€‰ä¸­çš„æ”¯ä»˜æ–¹å¼
         * åŠŸèƒ½æ¦‚è¿°ï¼šå­˜å‚¨ç”¨æˆ·é€‰æ‹©çš„æ”¯ä»˜æ–¹å¼ï¼ˆ'wechat'ã€'alipay'ã€'bank'ï¼‰
         */
        // é€‰ä¸­çš„æ”¯ä»˜æ–¹å¼ï¼Œåˆå§‹å€¼ä¸ºnull
        let selectedPaymentMethod = null;
        /**
         * è®¢å•å·
         * åŠŸèƒ½æ¦‚è¿°ï¼šä»URLæŸ¥è¯¢å‚æ•°ä¸­è·å–è®¢å•å·ï¼Œç”¨äºæ”¯ä»˜è¯·æ±‚
         */
        // ä»URLæŸ¥è¯¢å‚æ•°ä¸­è·å–è®¢å•å·
        const orderNo = new URLSearchParams(window.location.search).get('orderNo');

        // ==================== æ”¯ä»˜æ–¹å¼é€‰æ‹©åŠŸèƒ½æ¨¡å— ====================
        /**
         * é€‰æ‹©æ”¯ä»˜æ–¹å¼
         * åŠŸèƒ½æ¦‚è¿°ï¼šå½“ç”¨æˆ·ç‚¹å‡»æ”¯ä»˜æ–¹å¼é€‰é¡¹æ—¶ï¼Œæ›´æ–°é€‰ä¸­çš„æ”¯ä»˜æ–¹å¼ï¼Œæ›´æ–°UIçŠ¶æ€ï¼Œå¯ç”¨æ”¯ä»˜æŒ‰é’®
         * @param {String} method - æ”¯ä»˜æ–¹å¼ï¼ˆ'wechat'ã€'alipay'ã€'bank'ï¼‰
         */
        function selectPaymentMethod(method) {
            // æ›´æ–°é€‰ä¸­çš„æ”¯ä»˜æ–¹å¼
            selectedPaymentMethod = method;
            
            // æ›´æ–°UI
            // éå†æ‰€æœ‰æ”¯ä»˜æ–¹å¼é€‰é¡¹ï¼Œç§»é™¤selectedç±»ï¼Œå–æ¶ˆé€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            // ä¸ºå½“å‰ç‚¹å‡»çš„æ”¯ä»˜æ–¹å¼é€‰é¡¹æ·»åŠ selectedç±»ï¼Œæ¿€æ´»é€‰ä¸­çŠ¶æ€
            event.currentTarget.classList.add('selected');
            
            // å¯ç”¨æ”¯ä»˜æŒ‰é’®
            // ç§»é™¤æ”¯ä»˜æŒ‰é’®çš„disabledå±æ€§ï¼Œå…è®¸ç”¨æˆ·ç‚¹å‡»æ”¯ä»˜
            document.getElementById('payButton').disabled = false;
        }

        // ==================== æ”¯ä»˜å¤„ç†åŠŸèƒ½æ¨¡å— ====================
        /**
         * å¤„ç†æ”¯ä»˜
         * åŠŸèƒ½æ¦‚è¿°ï¼šéªŒè¯æ”¯ä»˜æ–¹å¼ï¼Œå‘é€æ”¯ä»˜è¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†æ”¯ä»˜ç»“æœï¼Œæ ¹æ®æ¥æºé¡µé¢æ™ºèƒ½è·³è½¬
         */
        function processPayment() {
            // åˆ¤æ–­æ˜¯å¦é€‰æ‹©äº†æ”¯ä»˜æ–¹å¼
            if (!selectedPaymentMethod) {
                // å¦‚æœæœªé€‰æ‹©æ”¯ä»˜æ–¹å¼ï¼Œæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                showError('è¯·é€‰æ‹©æ”¯ä»˜æ–¹å¼');
                // ç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­æ“ä½œ
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            // æ˜¾ç¤ºåŠ è½½æç¤ºï¼Œç¦ç”¨æ”¯ä»˜æŒ‰é’®
            showLoading(true);
            // éšè—é”™è¯¯æ¶ˆæ¯
            hideError();
            // éšè—æˆåŠŸæ¶ˆæ¯
            hideSuccess();

            // å‘é€æ”¯ä»˜è¯·æ±‚
            // ä½¿ç”¨fetch APIå‘é€POSTè¯·æ±‚åˆ°åç«¯æ”¯ä»˜å¤„ç†æ¥å£
            fetch('/unified-new/payment/process', {
                method: 'POST',  // è¯·æ±‚æ–¹æ³•ä¸ºPOST
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'  // è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šå†…å®¹ç±»å‹ä¸ºè¡¨å•æ•°æ®
                },
                body: `orderNo=${orderNo}&paymentMethod=${selectedPaymentMethod}`,  // å°†è®¢å•å·å’Œæ”¯ä»˜æ–¹å¼ç¼–ç åä½œä¸ºè¯·æ±‚ä½“
                credentials: 'include'  // åŒ…å«Cookieï¼Œç”¨äºèº«ä»½éªŒè¯
            })
            .then(response => response.json())  // å°†å“åº”è½¬æ¢ä¸ºJSONå¯¹è±¡
            .then(data => {
                // éšè—åŠ è½½çŠ¶æ€
                showLoading(false);
                // åˆ¤æ–­åç«¯æ˜¯å¦è¿”å›æˆåŠŸ
                if (data.success) {
                    // å¦‚æœæ”¯ä»˜æˆåŠŸï¼Œæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showSuccess('æ”¯ä»˜æˆåŠŸï¼æ­£åœ¨è·³è½¬...');
                    // å»¶è¿Ÿ2000æ¯«ç§’åè·³è½¬é¡µé¢
                    setTimeout(() => {
                        // æ£€æŸ¥æ¥æºé¡µé¢ï¼Œæ ¹æ®æ¥æºé¡µé¢å†³å®šè·³è½¬ä½ç½®
                        // è·å–æ¥æºé¡µé¢URL
                        const referrer = document.referrer;
                        // åˆ¤æ–­æ¥æºé¡µé¢æ˜¯å¦åŒ…å«'/payment'
                        if (referrer && referrer.includes('/payment')) {
                            // å¦‚æœæ˜¯ä»ç”Ÿæ´»ç¼´è´¹é¡µé¢è·³è½¬çš„ï¼Œè¿”å›åˆ°ç”Ÿæ´»ç¼´è´¹é¡µé¢å¹¶åˆ·æ–°
                            window.location.href = '/payment?refresh=true';
                        // åˆ¤æ–­æ¥æºé¡µé¢æ˜¯å¦åŒ…å«'/food'
                        } else if (referrer && referrer.includes('/food')) {
                            // å¦‚æœæ˜¯ä»ç¾é£Ÿé¡µé¢è·³è½¬çš„ï¼Œè¿”å›åˆ°ç¾é£Ÿé¡µé¢
                            window.location.href = '/food';
                        // åˆ¤æ–­æ¥æºé¡µé¢æ˜¯å¦åŒ…å«'/hc'
                        } else if (referrer && referrer.includes('/hc')) {
                            // å¦‚æœæ˜¯ä»é…’åº—é¡µé¢è·³è½¬çš„ï¼Œè¿”å›åˆ°é…’åº—é¡µé¢
                            window.location.href = '/hc/f2';
                        // åˆ¤æ–­æ¥æºé¡µé¢æ˜¯å¦åŒ…å«'/travel'
                        } else if (referrer && referrer.includes('/travel')) {
                            // å¦‚æœæ˜¯ä»æ—…æ¸¸é¡µé¢è·³è½¬çš„ï¼Œè¿”å›åˆ°æ—…æ¸¸é¡µé¢
                            window.location.href = '/travel';
                        // åˆ¤æ–­æ¥æºé¡µé¢æ˜¯å¦åŒ…å«'/shopping'
                        } else if (referrer && referrer.includes('/shopping')) {
                            // å¦‚æœæ˜¯ä»è´­ç‰©é¡µé¢è·³è½¬çš„ï¼Œè¿”å›åˆ°è´­ç‰©é¡µé¢
                            window.location.href = '/shopping';
                        // å…¶ä»–æƒ…å†µ
                        } else {
                            // å…¶ä»–æƒ…å†µè·³è½¬åˆ°è®¢å•ä¸­å¿ƒ
                            window.location.href = '/unified-new/orders';
                        }
                    }, 2000);
                // å¦‚æœåç«¯è¿”å›å¤±è´¥
                } else {
                    // æ˜¾ç¤ºæ”¯ä»˜å¤±è´¥æ¶ˆæ¯
                    showError('æ”¯ä»˜å¤±è´¥: ' + data.message);
                }
            })
            .catch(error => {
                // å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸ï¼Œéšè—åŠ è½½çŠ¶æ€
                showLoading(false);
                // æ˜¾ç¤ºæ”¯ä»˜å¤±è´¥æ¶ˆæ¯
                showError('æ”¯ä»˜å¤±è´¥: ' + error.message);
            });
        }

        // ==================== é¡µé¢å¯¼èˆªåŠŸèƒ½æ¨¡å— ====================
        /**
         * è¿”å›ä¸Šä¸€é¡µ
         * åŠŸèƒ½æ¦‚è¿°ï¼šè¿”å›æµè§ˆå™¨å†å²è®°å½•ä¸­çš„ä¸Šä¸€é¡µ
         */
        function goBack() {
            // è¿”å›æµè§ˆå™¨å†å²è®°å½•ä¸­çš„ä¸Šä¸€é¡µ
            window.history.back();
        }

        // ==================== æ¶ˆæ¯æç¤ºåŠŸèƒ½æ¨¡å— ====================
        /**
         * æ˜¾ç¤º/éšè—åŠ è½½çŠ¶æ€
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ˜¾ç¤ºæˆ–éšè—åŠ è½½æç¤ºï¼Œå¹¶æ§åˆ¶æ”¯ä»˜æŒ‰é’®çš„ç¦ç”¨çŠ¶æ€
         * @param {Boolean} show - æ˜¯å¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆtrueè¡¨ç¤ºæ˜¾ç¤ºï¼Œfalseè¡¨ç¤ºéšè—ï¼‰
         */
        function showLoading(show) {
            // è®¾ç½®åŠ è½½æç¤ºdivçš„æ˜¾ç¤ºçŠ¶æ€ï¼ˆshowä¸ºtrueæ—¶æ˜¾ç¤ºï¼Œfalseæ—¶éšè—ï¼‰
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            // è®¾ç½®æ”¯ä»˜æŒ‰é’®çš„ç¦ç”¨çŠ¶æ€ï¼ˆshowä¸ºtrueæ—¶ç¦ç”¨ï¼Œfalseæ—¶å¯ç”¨ï¼‰
            document.getElementById('payButton').disabled = show;
        }

        /**
         * æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯æç¤º
         * @param {String} message - é”™è¯¯æ¶ˆæ¯æ–‡æœ¬
         */
        function showError(message) {
            // è·å–é”™è¯¯æ¶ˆæ¯divå…ƒç´ 
            const errorDiv = document.getElementById('error');
            // è®¾ç½®é”™è¯¯æ¶ˆæ¯æ–‡æœ¬å†…å®¹
            errorDiv.textContent = message;
            // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
            errorDiv.style.display = 'block';
        }

        /**
         * éšè—é”™è¯¯æ¶ˆæ¯
         * åŠŸèƒ½æ¦‚è¿°ï¼šéšè—é”™è¯¯æ¶ˆæ¯æç¤º
         */
        function hideError() {
            // éšè—é”™è¯¯æ¶ˆæ¯divå…ƒç´ 
            document.getElementById('error').style.display = 'none';
        }

        /**
         * æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
         * åŠŸèƒ½æ¦‚è¿°ï¼šæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯æç¤º
         * @param {String} message - æˆåŠŸæ¶ˆæ¯æ–‡æœ¬
         */
        function showSuccess(message) {
            // è·å–æˆåŠŸæ¶ˆæ¯divå…ƒç´ 
            const successDiv = document.getElementById('success');
            // è®¾ç½®æˆåŠŸæ¶ˆæ¯æ–‡æœ¬å†…å®¹
            successDiv.textContent = message;
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            successDiv.style.display = 'block';
        }

        /**
         * éšè—æˆåŠŸæ¶ˆæ¯
         * åŠŸèƒ½æ¦‚è¿°ï¼šéšè—æˆåŠŸæ¶ˆæ¯æç¤º
         */
        function hideSuccess() {
            // éšè—æˆåŠŸæ¶ˆæ¯divå…ƒç´ 
            document.getElementById('success').style.display = 'none';
        }

        // ==================== é¡µé¢åˆå§‹åŒ–åŠŸèƒ½æ¨¡å— ====================
        /**
         * é¡µé¢åŠ è½½æ—¶æ£€æŸ¥è®¢å•çŠ¶æ€
         * åŠŸèƒ½æ¦‚è¿°ï¼šç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œå½“DOMåŠ è½½å®Œæˆåæ£€æŸ¥è®¢å•å·æ˜¯å¦å­˜åœ¨
         */
        // ç›‘å¬DOMContentLoadedäº‹ä»¶ï¼Œå½“DOMåŠ è½½å®Œæˆåè§¦å‘
        document.addEventListener('DOMContentLoaded', () => {
            // åˆ¤æ–­è®¢å•å·æ˜¯å¦å­˜åœ¨
            if (!orderNo) {
                // å¦‚æœè®¢å•å·ä¸å­˜åœ¨ï¼Œæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                showError('è®¢å•å·ä¸èƒ½ä¸ºç©º');
                // ç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­æ“ä½œ
                return;
            }
        });
    </script>
</body>
</html>
